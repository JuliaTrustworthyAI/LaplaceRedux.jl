<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Reference Â· LaplaceRedux.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://juliatrustworthyai.github.io/LaplaceRedux.jl/_reference/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="LaplaceRedux.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">LaplaceRedux.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/logit/">Logistic Regression</a></li><li><a class="tocitem" href="../tutorials/mlp/">MLP Binary Classifier</a></li><li><a class="tocitem" href="../tutorials/multi/">MLP Multi-Label Classifier</a></li><li><a class="tocitem" href="../tutorials/regression/">MLP Regression</a></li><li><a class="tocitem" href="../tutorials/prior/">A note on the prior ...</a></li></ul></li><li class="is-active"><a class="tocitem" href>Reference</a><ul class="internal"><li><a class="tocitem" href="#Exported-functions"><span>Exported functions</span></a></li><li><a class="tocitem" href="#Internal-functions"><span>Internal functions</span></a></li></ul></li><li><a class="tocitem" href="../resources/_resources/">Additional Resources</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Reference</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/main/docs/src/_reference.md#" title="Edit on GitHub"><span class="docs-icon fab">ï‚›</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="All-functions-and-types"><a class="docs-heading-anchor" href="#All-functions-and-types">All functions and types</a><a id="All-functions-and-types-1"></a><a class="docs-heading-anchor-permalink" href="#All-functions-and-types" title="Permalink"></a></h1><ul><li><a href="#LaplaceRedux.BaseLaplace-Tuple{AbstractArray}"><code>LaplaceRedux.BaseLaplace</code></a></li><li><a href="#LaplaceRedux.BaseLaplace"><code>LaplaceRedux.BaseLaplace</code></a></li><li><a href="#LaplaceRedux.Curvature.CurvatureInterface"><code>LaplaceRedux.Curvature.CurvatureInterface</code></a></li><li><a href="#LaplaceRedux.Curvature.EmpiricalFisher"><code>LaplaceRedux.Curvature.EmpiricalFisher</code></a></li><li><a href="#LaplaceRedux.Curvature.GGN"><code>LaplaceRedux.Curvature.GGN</code></a></li><li><a href="#LaplaceRedux.Curvature.Kron"><code>LaplaceRedux.Curvature.Kron</code></a></li><li><a href="#LaplaceRedux.Curvature.KronDecomposed"><code>LaplaceRedux.Curvature.KronDecomposed</code></a></li><li><a href="#LaplaceRedux.Laplace-Tuple{Any}"><code>LaplaceRedux.Laplace</code></a></li><li><a href="#LaplaceRedux.LaplaceApproximation-Union{Tuple{}, Tuple{L}, Tuple{O}, Tuple{F}, Tuple{B}} where {B, F, O, L}"><code>LaplaceRedux.LaplaceApproximation</code></a></li><li><a href="#Base.:*-Tuple{Real, LaplaceRedux.Curvature.Kron}"><code>Base.:*</code></a></li><li><a href="#Base.:*-Tuple{LaplaceRedux.Curvature.KronDecomposed, Number}"><code>Base.:*</code></a></li><li><a href="#Base.:+-Tuple{LaplaceRedux.Curvature.KronDecomposed, LinearAlgebra.Diagonal}"><code>Base.:+</code></a></li><li><a href="#Base.:+-Tuple{LaplaceRedux.Curvature.Kron, LaplaceRedux.Curvature.Kron}"><code>Base.:+</code></a></li><li><a href="#Base.:+-Tuple{LaplaceRedux.Curvature.KronDecomposed, Number}"><code>Base.:+</code></a></li><li><a href="#Base.:==-Tuple{LaplaceRedux.Curvature.Kron, LaplaceRedux.Curvature.Kron}"><code>Base.:==</code></a></li><li><a href="#Base.getindex-Tuple{LaplaceRedux.Curvature.KronDecomposed, Int64}"><code>Base.getindex</code></a></li><li><a href="#Base.getindex-Tuple{LaplaceRedux.Curvature.Kron, Int64}"><code>Base.getindex</code></a></li><li><a href="#Base.length-Tuple{LaplaceRedux.Curvature.KronDecomposed}"><code>Base.length</code></a></li><li><a href="#LaplaceRedux.Curvature.clamp-Tuple{LinearAlgebra.Eigen}"><code>LaplaceRedux.Curvature.clamp</code></a></li><li><a href="#LaplaceRedux.Curvature.decompose-Tuple{LaplaceRedux.Curvature.Kron}"><code>LaplaceRedux.Curvature.decompose</code></a></li><li><a href="#LaplaceRedux.Curvature.full-Tuple{LaplaceRedux.Curvature.EmpiricalFisher, Tuple}"><code>LaplaceRedux.Curvature.full</code></a></li><li><a href="#LaplaceRedux.Curvature.full-Tuple{LaplaceRedux.Curvature.GGN, Tuple}"><code>LaplaceRedux.Curvature.full</code></a></li><li><a href="#LaplaceRedux.Curvature.full_batched-Tuple{LaplaceRedux.Curvature.GGN, Tuple}"><code>LaplaceRedux.Curvature.full_batched</code></a></li><li><a href="#LaplaceRedux.Curvature.full_batched-Tuple{LaplaceRedux.Curvature.EmpiricalFisher, Tuple}"><code>LaplaceRedux.Curvature.full_batched</code></a></li><li><a href="#LaplaceRedux.Curvature.full_unbatched-Tuple{LaplaceRedux.Curvature.GGN, Tuple}"><code>LaplaceRedux.Curvature.full_unbatched</code></a></li><li><a href="#LaplaceRedux.Curvature.full_unbatched-Tuple{LaplaceRedux.Curvature.EmpiricalFisher, Tuple}"><code>LaplaceRedux.Curvature.full_unbatched</code></a></li><li><a href="#LaplaceRedux.Curvature.gradients-Tuple{LaplaceRedux.Curvature.CurvatureInterface, AbstractArray, Union{Number, AbstractArray}}"><code>LaplaceRedux.Curvature.gradients</code></a></li><li><a href="#LaplaceRedux.Curvature.interleave-Tuple"><code>LaplaceRedux.Curvature.interleave</code></a></li><li><a href="#LaplaceRedux.Curvature.jacobians-Tuple{LaplaceRedux.Curvature.CurvatureInterface, AbstractArray}"><code>LaplaceRedux.Curvature.jacobians</code></a></li><li><a href="#LaplaceRedux.Curvature.jacobians_batched-Tuple{LaplaceRedux.Curvature.CurvatureInterface, AbstractArray}"><code>LaplaceRedux.Curvature.jacobians_batched</code></a></li><li><a href="#LaplaceRedux.Curvature.jacobians_unbatched-Tuple{LaplaceRedux.Curvature.CurvatureInterface, AbstractArray}"><code>LaplaceRedux.Curvature.jacobians_unbatched</code></a></li><li><a href="#LaplaceRedux.Curvature.kron-Tuple{Union{LaplaceRedux.Curvature.EmpiricalFisher, LaplaceRedux.Curvature.GGN}, Any}"><code>LaplaceRedux.Curvature.kron</code></a></li><li><a href="#LaplaceRedux.Curvature.logdetblock-Tuple{Tuple{LinearAlgebra.Eigen, LinearAlgebra.Eigen}, Number}"><code>LaplaceRedux.Curvature.logdetblock</code></a></li><li><a href="#LaplaceRedux.Curvature.mm-Tuple{LaplaceRedux.Curvature.KronDecomposed, Any}"><code>LaplaceRedux.Curvature.mm</code></a></li><li><a href="#LaplaceRedux._H_factor-Tuple{LaplaceRedux.BaseLaplace}"><code>LaplaceRedux._H_factor</code></a></li><li><a href="#LaplaceRedux._init_H-Tuple{LaplaceRedux.BaseLaplace}"><code>LaplaceRedux._init_H</code></a></li><li><a href="#LaplaceRedux._weight_penalty-Tuple{LaplaceRedux.BaseLaplace}"><code>LaplaceRedux._weight_penalty</code></a></li><li><a href="#LaplaceRedux.convert_subnetwork_indices-Tuple{Vector{Vector{Int64}}, AbstractArray}"><code>LaplaceRedux.convert_subnetwork_indices</code></a></li><li><a href="#LaplaceRedux.fit!-Tuple{LaplaceRedux.BaseLaplace, MLUtils.DataLoader}"><code>LaplaceRedux.fit!</code></a></li><li><a href="#LaplaceRedux.fit!-Tuple{LaplaceRedux.BaseLaplace, Any}"><code>LaplaceRedux.fit!</code></a></li><li><a href="#LaplaceRedux.functional_variance-Tuple{LaplaceRedux.KronLaplace, Matrix}"><code>LaplaceRedux.functional_variance</code></a></li><li><a href="#LaplaceRedux.functional_variance-Tuple{Laplace, Any}"><code>LaplaceRedux.functional_variance</code></a></li><li><a href="#LaplaceRedux.get_loss_fun-Tuple{Symbol, Flux.Chain}"><code>LaplaceRedux.get_loss_fun</code></a></li><li><a href="#LaplaceRedux.get_loss_type-Tuple{Symbol, Flux.Chain}"><code>LaplaceRedux.get_loss_type</code></a></li><li><a href="#LaplaceRedux.get_params-Tuple{LaplaceRedux.BaseLaplace}"><code>LaplaceRedux.get_params</code></a></li><li><a href="#LaplaceRedux.glm_predictive_distribution-Tuple{LaplaceRedux.BaseLaplace, AbstractArray}"><code>LaplaceRedux.glm_predictive_distribution</code></a></li><li><a href="#LaplaceRedux.hessian_approximation-Tuple{LaplaceRedux.BaseLaplace, Any}"><code>LaplaceRedux.hessian_approximation</code></a></li><li><a href="#LaplaceRedux.inv_square_form-Tuple{LaplaceRedux.Curvature.KronDecomposed, Matrix}"><code>LaplaceRedux.inv_square_form</code></a></li><li><a href="#LaplaceRedux.log_det_posterior_precision-Tuple{LaplaceRedux.BaseLaplace}"><code>LaplaceRedux.log_det_posterior_precision</code></a></li><li><a href="#LaplaceRedux.log_det_prior_precision-Tuple{LaplaceRedux.BaseLaplace}"><code>LaplaceRedux.log_det_prior_precision</code></a></li><li><a href="#LaplaceRedux.log_det_ratio-Tuple{LaplaceRedux.BaseLaplace}"><code>LaplaceRedux.log_det_ratio</code></a></li><li><a href="#LaplaceRedux.log_likelihood-Tuple{LaplaceRedux.BaseLaplace}"><code>LaplaceRedux.log_likelihood</code></a></li><li><a href="#LaplaceRedux.log_marginal_likelihood-Tuple{LaplaceRedux.BaseLaplace}"><code>LaplaceRedux.log_marginal_likelihood</code></a></li><li><a href="#LaplaceRedux.optimize_prior!-Tuple{LaplaceRedux.BaseLaplace}"><code>LaplaceRedux.optimize_prior!</code></a></li><li><a href="#LaplaceRedux.outdim-Tuple{Flux.Chain}"><code>LaplaceRedux.outdim</code></a></li><li><a href="#LaplaceRedux.outdim-Tuple{LaplaceRedux.BaseLaplace}"><code>LaplaceRedux.outdim</code></a></li><li><a href="#LaplaceRedux.posterior_covariance"><code>LaplaceRedux.posterior_covariance</code></a></li><li><a href="#LaplaceRedux.posterior_precision"><code>LaplaceRedux.posterior_precision</code></a></li><li><a href="#LaplaceRedux.predict-Tuple{LaplaceRedux.BaseLaplace, AbstractArray}"><code>LaplaceRedux.predict</code></a></li><li><a href="#LaplaceRedux.predict-Tuple{LaplaceRedux.BaseLaplace, Matrix}"><code>LaplaceRedux.predict</code></a></li><li><a href="#LaplaceRedux.validate_subnetwork_indices-Tuple{Union{Nothing, Vector{Vector{Int64}}}, Any}"><code>LaplaceRedux.validate_subnetwork_indices</code></a></li><li><a href="#LinearAlgebra.det-Tuple{LaplaceRedux.Curvature.KronDecomposed}"><code>LinearAlgebra.det</code></a></li><li><a href="#LinearAlgebra.logdet-Tuple{LaplaceRedux.Curvature.KronDecomposed}"><code>LinearAlgebra.logdet</code></a></li><li><a href="#LaplaceRedux.@def-Tuple{Any, Any}"><code>LaplaceRedux.@def</code></a></li><li><a href="#LaplaceRedux.Curvature.@zb-Tuple{Any}"><code>LaplaceRedux.Curvature.@zb</code></a></li></ul><h2 id="Exported-functions"><a class="docs-heading-anchor" href="#Exported-functions">Exported functions</a><a id="Exported-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Exported-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.Laplace-Tuple{Any}" href="#LaplaceRedux.Laplace-Tuple{Any}"><code>LaplaceRedux.Laplace</code></a> â€” <span class="docstring-category">Method</span></header><section><div><p>Laplace(model::Any; loss_fun::Union{Symbol, Function}, kwargs...)</p><p>Wrapper function to prepare Laplace approximation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/laplace.jl#L75-L79">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.LaplaceApproximation-Union{Tuple{}, Tuple{L}, Tuple{O}, Tuple{F}, Tuple{B}} where {B, F, O, L}" href="#LaplaceRedux.LaplaceApproximation-Union{Tuple{}, Tuple{L}, Tuple{O}, Tuple{F}, Tuple{B}} where {B, F, O, L}"><code>LaplaceRedux.LaplaceApproximation</code></a> â€” <span class="docstring-category">Method</span></header><section><div><p>LaplaceApproximation(; builder::B, finaliser::F, optimiser::O, loss::L, epochs::Int, batch<em>size::Int, lambda::Float64, alpha::Float64, rng::Union{AbstractRNG,Int64}, optimiser</em>changes<em>trigger</em>retraining::Bool, acceleration::AbstractResource, likelihood::Symbol, subset<em>of</em>weights::Symbol, subnetwork<em>indices::Vector{Vector{Int}}, hessian</em>structure::Symbol, backend::Symbol, Ïƒ::Float64, Î¼â‚€::Float64, Pâ‚€::Union{AbstractMatrix,UniformScaling}, link<em>approx::Symbol, fit</em>params::Dict{Symbol,Any}, ) where {B,F,O,L}</p><p>Constructor for LaplaceApproximation, a wrapper for Laplace, a bayesian deep learning model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/mlj_flux.jl#L35-L61">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.fit!-Tuple{LaplaceRedux.BaseLaplace, Any}" href="#LaplaceRedux.fit!-Tuple{LaplaceRedux.BaseLaplace, Any}"><code>LaplaceRedux.fit!</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit!(la::BaseLaplace,data)</code></pre><p>Fits the Laplace approximation for a data set. The function returns the number of observations (n_data) that were used to update the Laplace object. It does not return the updated Laplace object itself because the function modifies the input Laplace object in place (as denoted by the use of &#39;!&#39; in the function&#39;s name).</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">using Flux, LaplaceRedux
x, y = LaplaceRedux.Data.toy_data_linear()
data = zip(x,y)
nn = Chain(Dense(2,1))
la = Laplace(nn)
fit!(la, data)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/baselaplace.jl#L177-L195">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.fit!-Tuple{LaplaceRedux.BaseLaplace, MLUtils.DataLoader}" href="#LaplaceRedux.fit!-Tuple{LaplaceRedux.BaseLaplace, MLUtils.DataLoader}"><code>LaplaceRedux.fit!</code></a> â€” <span class="docstring-category">Method</span></header><section><div><p>Fit the Laplace approximation, with batched data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/baselaplace.jl#L200-L202">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.glm_predictive_distribution-Tuple{LaplaceRedux.BaseLaplace, AbstractArray}" href="#LaplaceRedux.glm_predictive_distribution-Tuple{LaplaceRedux.BaseLaplace, AbstractArray}"><code>LaplaceRedux.glm_predictive_distribution</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">glm_predictive_distribution(la::BaseLaplace, X::AbstractArray)</code></pre><p>Computes the linearized GLM predictive.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/baselaplace.jl#L207-L211">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.optimize_prior!-Tuple{LaplaceRedux.BaseLaplace}" href="#LaplaceRedux.optimize_prior!-Tuple{LaplaceRedux.BaseLaplace}"><code>LaplaceRedux.optimize_prior!</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">optimize_prior!(
    la::BaseLaplace; 
    n_steps::Int=100, lr::Real=1e-1,
    Î»init::Union{Nothing,Real}=nothing,
    Ïƒinit::Union{Nothing,Real}=nothing
)</code></pre><p>Optimize the prior precision post-hoc through Empirical Bayes (marginal log-likelihood maximization).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/baselaplace.jl#L289-L298">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.posterior_covariance" href="#LaplaceRedux.posterior_covariance"><code>LaplaceRedux.posterior_covariance</code></a> â€” <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">posterior_covariance(la::BaseLaplace, P=la.P)</code></pre><p>Computes the posterior covariance <span>$âˆ‘$</span> as the inverse of the posterior precision: <span>$\Sigma=P^{-1}$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/baselaplace.jl#L65-L69">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.posterior_precision" href="#LaplaceRedux.posterior_precision"><code>LaplaceRedux.posterior_precision</code></a> â€” <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">posterior_precision(la::BaseLaplace)</code></pre><p>Computes the posterior precision <span>$P$</span> for a fitted Laplace Approximation as follows,</p><p><span>$P = \sum_{n=1}^N\nabla_{\theta}^2\log p(\mathcal{D}_n|\theta)|_{\theta}_{MAP} + \nabla_{\theta}^2 \log p(\theta)|_{\theta}_{MAP}$</span></p><p>where <span>$\sum_{n=1}^N\nabla_{\theta}^2\log p(\mathcal{D}_n|\theta)|_{\theta}_{MAP}=H$</span> and <span>$\nabla_{\theta}^2 \log p(\theta)|_{\theta}_{MAP}=P_0$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/baselaplace.jl#L49-L59">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.predict-Tuple{LaplaceRedux.BaseLaplace, AbstractArray}" href="#LaplaceRedux.predict-Tuple{LaplaceRedux.BaseLaplace, AbstractArray}"><code>LaplaceRedux.predict</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">predict(la::BaseLaplace, X::AbstractArray; link_approx=:probit)</code></pre><p>Computes predictions from Bayesian neural network.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">using Flux, LaplaceRedux
x, y = toy_data_linear()
data = zip(x,y)
nn = Chain(Dense(2,1))
la = Laplace(nn)
fit!(la, data)
predict(la, hcat(x...))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/baselaplace.jl#L220-L237">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.predict-Tuple{LaplaceRedux.BaseLaplace, Matrix}" href="#LaplaceRedux.predict-Tuple{LaplaceRedux.BaseLaplace, Matrix}"><code>LaplaceRedux.predict</code></a> â€” <span class="docstring-category">Method</span></header><section><div><p>Compute predictive posteriors for a batch of inputs.</p><p>Note, input is assumed to be batched only if it is a matrix. If the input dimensionality of the model is 1 (a vector), one should still prepare a 1Ã—B matrix batch as input.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/baselaplace.jl#L270-L275">source</a></section></article><h2 id="Internal-functions"><a class="docs-heading-anchor" href="#Internal-functions">Internal functions</a><a id="Internal-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Internal-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.BaseLaplace" href="#LaplaceRedux.BaseLaplace"><code>LaplaceRedux.BaseLaplace</code></a> â€” <span class="docstring-category">Type</span></header><section><div><p>Abstract base type for all Laplace approximations in this library</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/baselaplace.jl#L4">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.BaseLaplace-Tuple{AbstractArray}" href="#LaplaceRedux.BaseLaplace-Tuple{AbstractArray}"><code>LaplaceRedux.BaseLaplace</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">(la::BaseLaplace)(X::AbstractArray; kwrgs...)</code></pre><p>Calling a model with Laplace Approximation on an array of inputs is equivalent to explicitly calling the <code>predict</code> function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/baselaplace.jl#L280-L284">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux._H_factor-Tuple{LaplaceRedux.BaseLaplace}" href="#LaplaceRedux._H_factor-Tuple{LaplaceRedux.BaseLaplace}"><code>LaplaceRedux._H_factor</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">_H_factor(la::BaseLaplace)</code></pre><p>Returns the factor Ïƒâ»Â², where Ïƒ is used in the zero-centered Gaussian prior p(Î¸) = N(Î¸;0,ÏƒÂ²I)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/baselaplace.jl#L90-L94">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux._init_H-Tuple{LaplaceRedux.BaseLaplace}" href="#LaplaceRedux._init_H-Tuple{LaplaceRedux.BaseLaplace}"><code>LaplaceRedux._init_H</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">_init_H(la::BaseLaplace)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/baselaplace.jl#L97-L101">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux._weight_penalty-Tuple{LaplaceRedux.BaseLaplace}" href="#LaplaceRedux._weight_penalty-Tuple{LaplaceRedux.BaseLaplace}"><code>LaplaceRedux._weight_penalty</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">_weight_penalty(la::BaseLaplace)</code></pre><p>The weight penalty term is a regularization term used to prevent overfitting. Weight regularization methods such as weight decay introduce a penalty to the loss function when training a neural network to encourage the network to use small weights. Smaller weights in a neural network can result in a model that is more stable and less likely to overfit the training dataset, in turn having better performance when  making a prediction on new data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/baselaplace.jl#L104-L111">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.convert_subnetwork_indices-Tuple{Vector{Vector{Int64}}, AbstractArray}" href="#LaplaceRedux.convert_subnetwork_indices-Tuple{Vector{Vector{Int64}}, AbstractArray}"><code>LaplaceRedux.convert_subnetwork_indices</code></a> â€” <span class="docstring-category">Method</span></header><section><div><p>convert<em>subnetwork</em>indices(subnetwork_indices::AbstractArray)</p><p>Converts the subnetwork indices from the user given format [theta, row, column] to an Int i that corresponds to the index of that weight in the flattened array of weights.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/laplace.jl#L183-L188">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.functional_variance-Tuple{Laplace, Any}" href="#LaplaceRedux.functional_variance-Tuple{Laplace, Any}"><code>LaplaceRedux.functional_variance</code></a> â€” <span class="docstring-category">Method</span></header><section><div><p>functional_variance(la::Laplace,ğ‰)</p><p>Compute the linearized GLM predictive variance as <code>ğ‰â‚™Î£ğ‰â‚™&#39;</code> where <code>ğ‰=âˆ‡f(x;Î¸)|Î¸Ì‚</code> is the Jacobian evaluated at the MAP estimate and <code>Î£ = Pâ»Â¹</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/laplace.jl#L253-L257">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.functional_variance-Tuple{LaplaceRedux.KronLaplace, Matrix}" href="#LaplaceRedux.functional_variance-Tuple{LaplaceRedux.KronLaplace, Matrix}"><code>LaplaceRedux.functional_variance</code></a> â€” <span class="docstring-category">Method</span></header><section><div><p>functional_variance(la::KronLaplace, ğ‰::Matrix)</p><p>Compute functional variance for the GLM predictive: as the diagonal of the KÃ—K predictive output covariance matrix ğ‰ğâ»Â¹ğ‰áµ€, where K is the number of outputs, ğ is the posterior precision, and ğ‰ is the Jacobian of model output <code>ğ‰=âˆ‡f(x;Î¸)|Î¸Ì‚</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/laplace.jl#L264-L269">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.get_loss_fun-Tuple{Symbol, Flux.Chain}" href="#LaplaceRedux.get_loss_fun-Tuple{Symbol, Flux.Chain}"><code>LaplaceRedux.get_loss_fun</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_loss_fun(likelihood::Symbol)</code></pre><p>Helper function to choose loss function based on specified model <code>likelihood</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/utils.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.get_loss_type-Tuple{Symbol, Flux.Chain}" href="#LaplaceRedux.get_loss_type-Tuple{Symbol, Flux.Chain}"><code>LaplaceRedux.get_loss_type</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_loss_type(likelihood::Symbol)</code></pre><p>Choose loss function type based on specified model <code>likelihood</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/utils.jl#L15-L19">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.get_params-Tuple{LaplaceRedux.BaseLaplace}" href="#LaplaceRedux.get_params-Tuple{LaplaceRedux.BaseLaplace}"><code>LaplaceRedux.get_params</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_params(la::BaseLaplace)</code></pre><p>Retrieves the desired (sub)set of model parameters and stores them in a list.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">using Flux, LaplaceRedux
# define a neural network with one hidden layer that takes a two-dimensional input and produces a one-dimensional output
nn = Chain(Dense(2,1))
la = Laplace(nn)
LaplaceRedux.get_params(la)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/baselaplace.jl#L17-L32">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.hessian_approximation-Tuple{LaplaceRedux.BaseLaplace, Any}" href="#LaplaceRedux.hessian_approximation-Tuple{LaplaceRedux.BaseLaplace, Any}"><code>LaplaceRedux.hessian_approximation</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">hessian_approximation(la::BaseLaplace, d; batched::Bool=false)</code></pre><p>Computes the local Hessian approximation at a single datapoint <code>d</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/baselaplace.jl#L167-L171">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.inv_square_form-Tuple{LaplaceRedux.Curvature.KronDecomposed, Matrix}" href="#LaplaceRedux.inv_square_form-Tuple{LaplaceRedux.Curvature.KronDecomposed, Matrix}"><code>LaplaceRedux.inv_square_form</code></a> â€” <span class="docstring-category">Method</span></header><section><div><p>function inv<em>square</em>form(K::KronDecomposed, W::Matrix)</p><p>Special function to compute the inverse square form ğ‰ğâ»Â¹ğ‰áµ€ (or ğ–ğŠâ»Â¹ğ–áµ€)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/laplace.jl#L274-L278">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.log_det_posterior_precision-Tuple{LaplaceRedux.BaseLaplace}" href="#LaplaceRedux.log_det_posterior_precision-Tuple{LaplaceRedux.BaseLaplace}"><code>LaplaceRedux.log_det_posterior_precision</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">log_det_posterior_precision(la::BaseLaplace)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/baselaplace.jl#L160-L164">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.log_det_prior_precision-Tuple{LaplaceRedux.BaseLaplace}" href="#LaplaceRedux.log_det_prior_precision-Tuple{LaplaceRedux.BaseLaplace}"><code>LaplaceRedux.log_det_prior_precision</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">log_det_prior_precision(la::BaseLaplace)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/baselaplace.jl#L153-L157">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.log_det_ratio-Tuple{LaplaceRedux.BaseLaplace}" href="#LaplaceRedux.log_det_ratio-Tuple{LaplaceRedux.BaseLaplace}"><code>LaplaceRedux.log_det_ratio</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">log_det_ratio(la::BaseLaplace)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/baselaplace.jl#L144-L148">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.log_likelihood-Tuple{LaplaceRedux.BaseLaplace}" href="#LaplaceRedux.log_likelihood-Tuple{LaplaceRedux.BaseLaplace}"><code>LaplaceRedux.log_likelihood</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">log_likelihood(la::BaseLaplace)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/baselaplace.jl#L75-L79">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.log_marginal_likelihood-Tuple{LaplaceRedux.BaseLaplace}" href="#LaplaceRedux.log_marginal_likelihood-Tuple{LaplaceRedux.BaseLaplace}"><code>LaplaceRedux.log_marginal_likelihood</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">log_marginal_likelihood(la::BaseLaplace; Pâ‚€::Union{Nothing,UniformScaling}=nothing, Ïƒ::Union{Nothing, Real}=nothing)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/baselaplace.jl#L119-L123">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.outdim-Tuple{Flux.Chain}" href="#LaplaceRedux.outdim-Tuple{Flux.Chain}"><code>LaplaceRedux.outdim</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">outdim(model::Chain)</code></pre><p>Helper function to determine the output dimension of a <code>Flux.Chain</code>, corresponding to the number of neurons on the last layer of the NN.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/utils.jl#L33-L39">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.outdim-Tuple{LaplaceRedux.BaseLaplace}" href="#LaplaceRedux.outdim-Tuple{LaplaceRedux.BaseLaplace}"><code>LaplaceRedux.outdim</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">outdim(la::BaseLaplace)</code></pre><p>Helper function to determine the output dimension, corresponding to the number of neurons  on the last layer of the NN, of a <code>Flux.Chain</code> with Laplace approximation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/baselaplace.jl#L9-L14">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.validate_subnetwork_indices-Tuple{Union{Nothing, Vector{Vector{Int64}}}, Any}" href="#LaplaceRedux.validate_subnetwork_indices-Tuple{Union{Nothing, Vector{Vector{Int64}}}, Any}"><code>LaplaceRedux.validate_subnetwork_indices</code></a> â€” <span class="docstring-category">Method</span></header><section><div><p>validate<em>subnetwork</em>indices( subnetwork_indices::Union{Nothing,Vector{Vector{Int}}}, params )</p><p>Determines whether subnetwork_indices is a valid input for specified parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/laplace.jl#L154-L160">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.@def-Tuple{Any, Any}" href="#LaplaceRedux.@def-Tuple{Any, Any}"><code>LaplaceRedux.@def</code></a> â€” <span class="docstring-category">Macro</span></header><section><div><p>Compile-time copy-paste macro @def: a macro that creates a macro with the specified name and content, which is then immediately applied to the code.</p><p>Ref: https://www.stochasticlifestyle.com/type-dispatch-design-post-object-oriented-programming-julia/</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/laplace.jl#L8-L13">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.Curvature.CurvatureInterface" href="#LaplaceRedux.Curvature.CurvatureInterface"><code>LaplaceRedux.Curvature.CurvatureInterface</code></a> â€” <span class="docstring-category">Type</span></header><section><div><p>Basetype for any curvature interface.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L11">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.Curvature.EmpiricalFisher" href="#LaplaceRedux.Curvature.EmpiricalFisher"><code>LaplaceRedux.Curvature.EmpiricalFisher</code></a> â€” <span class="docstring-category">Type</span></header><section><div><p>Constructor for curvature approximated by empirical Fisher.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L180">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.Curvature.GGN" href="#LaplaceRedux.Curvature.GGN"><code>LaplaceRedux.Curvature.GGN</code></a> â€” <span class="docstring-category">Type</span></header><section><div><p>Constructor for curvature approximated by Generalized Gauss-Newton.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L89">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.Curvature.Kron" href="#LaplaceRedux.Curvature.Kron"><code>LaplaceRedux.Curvature.Kron</code></a> â€” <span class="docstring-category">Type</span></header><section><div><p>Kronecker-factored approximate curvature representation for a neural network model. Each element in kfacs represents two Kronecker factors (ğ†, ğ€), such that the full block Hessian approximation would be approximated as ğ€âŠ—ğ†.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L283-L286">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.Curvature.KronDecomposed" href="#LaplaceRedux.Curvature.KronDecomposed"><code>LaplaceRedux.Curvature.KronDecomposed</code></a> â€” <span class="docstring-category">Type</span></header><section><div><p>Decomposed Kronecker-factored approximate curvature representation for a neural network model.</p><p>Decomposition is required to add the prior (diagonal matrix) to the posterior (<code>KronDecomposed</code>). It also has the benefits of reducing the costs for computation of inverses and log-determinants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L426-L431">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.:*-Tuple{LaplaceRedux.Curvature.KronDecomposed, Number}" href="#Base.:*-Tuple{LaplaceRedux.Curvature.KronDecomposed, Number}"><code>Base.:*</code></a> â€” <span class="docstring-category">Method</span></header><section><div><p>Multiply by a scalar by changing the eigenvalues. Distribute the scalar along the factors of a block.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L474-L476">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.:*-Tuple{Real, LaplaceRedux.Curvature.Kron}" href="#Base.:*-Tuple{Real, LaplaceRedux.Curvature.Kron}"><code>Base.:*</code></a> â€” <span class="docstring-category">Method</span></header><section><div><p>Kronecker-factored curvature scalar scaling.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L309-L311">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.:+-Tuple{LaplaceRedux.Curvature.Kron, LaplaceRedux.Curvature.Kron}" href="#Base.:+-Tuple{LaplaceRedux.Curvature.Kron, LaplaceRedux.Curvature.Kron}"><code>Base.:+</code></a> â€” <span class="docstring-category">Method</span></header><section><div><p>Kronecker-factored curvature sum.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L291-L293">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.:+-Tuple{LaplaceRedux.Curvature.KronDecomposed, LinearAlgebra.Diagonal}" href="#Base.:+-Tuple{LaplaceRedux.Curvature.KronDecomposed, LinearAlgebra.Diagonal}"><code>Base.:+</code></a> â€” <span class="docstring-category">Method</span></header><section><div><p>Shift the factors by a diagonal (assumed uniform scaling)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L467-L469">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.:+-Tuple{LaplaceRedux.Curvature.KronDecomposed, Number}" href="#Base.:+-Tuple{LaplaceRedux.Curvature.KronDecomposed, Number}"><code>Base.:+</code></a> â€” <span class="docstring-category">Method</span></header><section><div><p>Shift the factors by a scalar across the diagonal.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L460-L462">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.:==-Tuple{LaplaceRedux.Curvature.Kron, LaplaceRedux.Curvature.Kron}" href="#Base.:==-Tuple{LaplaceRedux.Curvature.Kron, LaplaceRedux.Curvature.Kron}"><code>Base.:==</code></a> â€” <span class="docstring-category">Method</span></header><section><div><p>Kronecker-factored curvature equality.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L302-L304">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.getindex-Tuple{LaplaceRedux.Curvature.Kron, Int64}" href="#Base.getindex-Tuple{LaplaceRedux.Curvature.Kron, Int64}"><code>Base.getindex</code></a> â€” <span class="docstring-category">Method</span></header><section><div><p>Get Kronecker-factored block represenation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L320-L322">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.getindex-Tuple{LaplaceRedux.Curvature.KronDecomposed, Int64}" href="#Base.getindex-Tuple{LaplaceRedux.Curvature.KronDecomposed, Int64}"><code>Base.getindex</code></a> â€” <span class="docstring-category">Method</span></header><section><div><p>Get i-th block of a a Kronecker-factored curvature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L495-L497">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.length-Tuple{LaplaceRedux.Curvature.KronDecomposed}" href="#Base.length-Tuple{LaplaceRedux.Curvature.KronDecomposed}"><code>Base.length</code></a> â€” <span class="docstring-category">Method</span></header><section><div><p>Number of blocks in a Kronecker-factored curvature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L488-L490">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.Curvature.clamp-Tuple{LinearAlgebra.Eigen}" href="#LaplaceRedux.Curvature.clamp-Tuple{LinearAlgebra.Eigen}"><code>LaplaceRedux.Curvature.clamp</code></a> â€” <span class="docstring-category">Method</span></header><section><div><p>Clamp eigenvalues in an eigendecomposition to be non-negative.</p><p>Since the Fisher information matrix is a positive-semidefinite by construction, the (near-zero) negative eigenvalues should be neglected.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L440-L445">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.Curvature.decompose-Tuple{LaplaceRedux.Curvature.Kron}" href="#LaplaceRedux.Curvature.decompose-Tuple{LaplaceRedux.Curvature.Kron}"><code>LaplaceRedux.Curvature.decompose</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">decompose(K::Kron)</code></pre><p>Eigendecompose Kronecker factors and turn into <code>KronDecomposed</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L450-L454">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.Curvature.full-Tuple{LaplaceRedux.Curvature.EmpiricalFisher, Tuple}" href="#LaplaceRedux.Curvature.full-Tuple{LaplaceRedux.Curvature.EmpiricalFisher, Tuple}"><code>LaplaceRedux.Curvature.full</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">full(curvature::EmpiricalFisher, d::Tuple; batched::Bool=false)</code></pre><p>Compute the full empirical Fisher for either a single input-output datapoint or a batch of such. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L207-L211">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.Curvature.full-Tuple{LaplaceRedux.Curvature.GGN, Tuple}" href="#LaplaceRedux.Curvature.full-Tuple{LaplaceRedux.Curvature.GGN, Tuple}"><code>LaplaceRedux.Curvature.full</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">full(curvature::GGN, d::Tuple; batched::Bool=false)</code></pre><p>Compute the full GGN, for either a single input-output datapoint or a batch of such. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L116-L120">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.Curvature.full_batched-Tuple{LaplaceRedux.Curvature.EmpiricalFisher, Tuple}" href="#LaplaceRedux.Curvature.full_batched-Tuple{LaplaceRedux.Curvature.EmpiricalFisher, Tuple}"><code>LaplaceRedux.Curvature.full_batched</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">full_batched(curvature::EmpiricalFisher, d::Tuple)</code></pre><p>Compute the full empirical Fisher for batch of inputs-outputs, with the batch dimension at the end.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L245-L249">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.Curvature.full_batched-Tuple{LaplaceRedux.Curvature.GGN, Tuple}" href="#LaplaceRedux.Curvature.full_batched-Tuple{LaplaceRedux.Curvature.GGN, Tuple}"><code>LaplaceRedux.Curvature.full_batched</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">full_batched(curvature::GGN, d::Tuple)</code></pre><p>Compute the full GGN for batch of inputs-outputs, with the batch dimension at the end.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L153-L157">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.Curvature.full_unbatched-Tuple{LaplaceRedux.Curvature.EmpiricalFisher, Tuple}" href="#LaplaceRedux.Curvature.full_unbatched-Tuple{LaplaceRedux.Curvature.EmpiricalFisher, Tuple}"><code>LaplaceRedux.Curvature.full_unbatched</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">full_unbatched(curvature::EmpiricalFisher, d::Tuple)</code></pre><p>Compute the full empirical Fisher for a single datapoint.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L220-L224">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.Curvature.full_unbatched-Tuple{LaplaceRedux.Curvature.GGN, Tuple}" href="#LaplaceRedux.Curvature.full_unbatched-Tuple{LaplaceRedux.Curvature.GGN, Tuple}"><code>LaplaceRedux.Curvature.full_unbatched</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">full_unbatched(curvature::GGN, d::Tuple)</code></pre><p>Compute the full GGN for a singular input-ouput datapoint. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L129-L133">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.Curvature.gradients-Tuple{LaplaceRedux.Curvature.CurvatureInterface, AbstractArray, Union{Number, AbstractArray}}" href="#LaplaceRedux.Curvature.gradients-Tuple{LaplaceRedux.Curvature.CurvatureInterface, AbstractArray, Union{Number, AbstractArray}}"><code>LaplaceRedux.Curvature.gradients</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">gradients(curvature::CurvatureInterface, X::AbstractArray, y::Number)</code></pre><p>Compute the gradients with respect to the loss function: <code>âˆ‡â„“(f(x;Î¸),y)</code> where <code>f: â„á´° â†¦ â„á´·</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L76-L80">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.Curvature.interleave-Tuple" href="#LaplaceRedux.Curvature.interleave-Tuple"><code>LaplaceRedux.Curvature.interleave</code></a> â€” <span class="docstring-category">Method</span></header><section><div><p>Interleave elements of multiple iterables in order provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L327-L329">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.Curvature.jacobians-Tuple{LaplaceRedux.Curvature.CurvatureInterface, AbstractArray}" href="#LaplaceRedux.Curvature.jacobians-Tuple{LaplaceRedux.Curvature.CurvatureInterface, AbstractArray}"><code>LaplaceRedux.Curvature.jacobians</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">jacobians(curvature::CurvatureInterface, X::AbstractArray; batched::Bool=false)</code></pre><p>Computes the Jacobian <code>âˆ‡f(x;Î¸)</code> where <code>f: â„á´° â†¦ â„á´·</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L14-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.Curvature.jacobians_batched-Tuple{LaplaceRedux.Curvature.CurvatureInterface, AbstractArray}" href="#LaplaceRedux.Curvature.jacobians_batched-Tuple{LaplaceRedux.Curvature.CurvatureInterface, AbstractArray}"><code>LaplaceRedux.Curvature.jacobians_batched</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">jacobians_batched(curvature::CurvatureInterface, X::AbstractArray)</code></pre><p>Compute Jacobians of the model output w.r.t. model parameters for points in X, with batching.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L50-L54">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.Curvature.jacobians_unbatched-Tuple{LaplaceRedux.Curvature.CurvatureInterface, AbstractArray}" href="#LaplaceRedux.Curvature.jacobians_unbatched-Tuple{LaplaceRedux.Curvature.CurvatureInterface, AbstractArray}"><code>LaplaceRedux.Curvature.jacobians_unbatched</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">jacobians_unbatched(curvature::CurvatureInterface, X::AbstractArray)</code></pre><p>Compute the Jacobian of the model output w.r.t. model parameters for the point X, without batching. Here, the nn function is wrapped in an anonymous function using the () -&gt; syntax, which allows it to be differentiated using automatic differentiation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L27-L32">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.Curvature.kron-Tuple{Union{LaplaceRedux.Curvature.EmpiricalFisher, LaplaceRedux.Curvature.GGN}, Any}" href="#LaplaceRedux.Curvature.kron-Tuple{Union{LaplaceRedux.Curvature.EmpiricalFisher, LaplaceRedux.Curvature.GGN}, Any}"><code>LaplaceRedux.Curvature.kron</code></a> â€” <span class="docstring-category">Method</span></header><section><div><p>Compute the eigendecomposed Kronecker-factored approximate curvature as the Fisher information matrix.</p><p>Note, since the network predictive distribution is used in a weighted sum, and the number of backward passes is linear in the number of target classes, e.g. 100 for CIFAR-100.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L334-L339">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.Curvature.logdetblock-Tuple{Tuple{LinearAlgebra.Eigen, LinearAlgebra.Eigen}, Number}" href="#LaplaceRedux.Curvature.logdetblock-Tuple{Tuple{LinearAlgebra.Eigen, LinearAlgebra.Eigen}, Number}"><code>LaplaceRedux.Curvature.logdetblock</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">logdetblock(block::Tuple{Eigen,Eigen}, delta::Number)</code></pre><p>Log-determinant of a block in KronDecomposed, shifted by delta by on the diagonal.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L506-L510">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.Curvature.mm-Tuple{LaplaceRedux.Curvature.KronDecomposed, Any}" href="#LaplaceRedux.Curvature.mm-Tuple{LaplaceRedux.Curvature.KronDecomposed, Any}"><code>LaplaceRedux.Curvature.mm</code></a> â€” <span class="docstring-category">Method</span></header><section><div><p>Matrix-multuply for the KronDecomposed Hessian approximation K and a 2-d matrix W, applying an exponent to K and transposing W before multiplication. Return <code>(K^x)W^T</code>, where <code>x</code> is the exponent.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L534-L538">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LinearAlgebra.det-Tuple{LaplaceRedux.Curvature.KronDecomposed}" href="#LinearAlgebra.det-Tuple{LaplaceRedux.Curvature.KronDecomposed}"><code>LinearAlgebra.det</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">det(K::KronDecomposed)</code></pre><p>Log-determinant of the KronDecomposed block-diagonal matrix, as the exponentiated log-determinant.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L525-L529">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LinearAlgebra.logdet-Tuple{LaplaceRedux.Curvature.KronDecomposed}" href="#LinearAlgebra.logdet-Tuple{LaplaceRedux.Curvature.KronDecomposed}"><code>LinearAlgebra.logdet</code></a> â€” <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">logdet(K::KronDecomposed)</code></pre><p>Log-determinant of the KronDecomposed block-diagonal matrix, as the product of the determinants of the blocks</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L516-L520">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LaplaceRedux.Curvature.@zb-Tuple{Any}" href="#LaplaceRedux.Curvature.@zb-Tuple{Any}"><code>LaplaceRedux.Curvature.@zb</code></a> â€” <span class="docstring-category">Macro</span></header><section><div><p>Macro for zero-based indexing. Example of usage: (@zb A[0]) = ...</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/2333e04e63a38bf19250998d2c25235e850a9066/src/curvature/functions.jl#L271-L273">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorials/prior/">Â« A note on the prior ...</a><a class="docs-footer-nextpage" href="../resources/_resources/">Additional Resources Â»</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Friday 7 July 2023 08:13">Friday 7 July 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
