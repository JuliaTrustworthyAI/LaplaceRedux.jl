<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Reference ¬∑ LaplaceRedux.jl</title><meta name="title" content="Reference ¬∑ LaplaceRedux.jl"/><meta property="og:title" content="Reference ¬∑ LaplaceRedux.jl"/><meta property="twitter:title" content="Reference ¬∑ LaplaceRedux.jl"/><meta name="description" content="Documentation for LaplaceRedux.jl."/><meta property="og:description" content="Documentation for LaplaceRedux.jl."/><meta property="twitter:description" content="Documentation for LaplaceRedux.jl."/><meta property="og:url" content="https://juliatrustworthyai.github.io/LaplaceRedux.jl/reference/"/><meta property="twitter:url" content="https://juliatrustworthyai.github.io/LaplaceRedux.jl/reference/"/><link rel="canonical" href="https://juliatrustworthyai.github.io/LaplaceRedux.jl/reference/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="LaplaceRedux.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">LaplaceRedux.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/logit/">Logistic Regression</a></li><li><a class="tocitem" href="../tutorials/mlp/">MLP Binary Classifier</a></li><li><a class="tocitem" href="../tutorials/multi/">MLP Multi-Label Classifier</a></li><li><a class="tocitem" href="../tutorials/regression/">MLP Regression</a></li><li><a class="tocitem" href="../tutorials/prior/">A note on the prior ...</a></li></ul></li><li class="is-active"><a class="tocitem" href>Reference</a><ul class="internal"><li><a class="tocitem" href="#Exported-functions"><span>Exported functions</span></a></li><li><a class="tocitem" href="#Internal-functions"><span>Internal functions</span></a></li></ul></li><li><a class="tocitem" href="../resources/_resources/">Additional Resources</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/main/docs/src/reference.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="All-functions-and-types"><a class="docs-heading-anchor" href="#All-functions-and-types">All functions and types</a><a id="All-functions-and-types-1"></a><a class="docs-heading-anchor-permalink" href="#All-functions-and-types" title="Permalink"></a></h1><ul><li><a href="#LaplaceRedux.AbstractDecomposition"><code>LaplaceRedux.AbstractDecomposition</code></a></li><li><a href="#LaplaceRedux.AbstractLaplace"><code>LaplaceRedux.AbstractLaplace</code></a></li><li><a href="#LaplaceRedux.AbstractLaplace-Tuple{AbstractArray}"><code>LaplaceRedux.AbstractLaplace</code></a></li><li><a href="#LaplaceRedux.Curvature.CurvatureInterface"><code>LaplaceRedux.Curvature.CurvatureInterface</code></a></li><li><a href="#LaplaceRedux.Curvature.EmpiricalFisher"><code>LaplaceRedux.Curvature.EmpiricalFisher</code></a></li><li><a href="#LaplaceRedux.Curvature.GGN"><code>LaplaceRedux.Curvature.GGN</code></a></li><li><a href="#LaplaceRedux.EstimationParams-Tuple{LaplaceRedux.LaplaceParams, Any, Symbol}"><code>LaplaceRedux.EstimationParams</code></a></li><li><a href="#LaplaceRedux.EstimationParams"><code>LaplaceRedux.EstimationParams</code></a></li><li><a href="#LaplaceRedux.FullHessian"><code>LaplaceRedux.FullHessian</code></a></li><li><a href="#LaplaceRedux.HessianStructure"><code>LaplaceRedux.HessianStructure</code></a></li><li><a href="#LaplaceRedux.Kron"><code>LaplaceRedux.Kron</code></a></li><li><a href="#LaplaceRedux.KronDecomposed"><code>LaplaceRedux.KronDecomposed</code></a></li><li><a href="#LaplaceRedux.KronHessian"><code>LaplaceRedux.KronHessian</code></a></li><li><a href="#LaplaceRedux.Laplace"><code>LaplaceRedux.Laplace</code></a></li><li><a href="#LaplaceRedux.Laplace-Tuple{Any}"><code>LaplaceRedux.Laplace</code></a></li><li><a href="#LaplaceRedux.LaplaceClassification"><code>LaplaceRedux.LaplaceClassification</code></a></li><li><a href="#LaplaceRedux.LaplaceParams"><code>LaplaceRedux.LaplaceParams</code></a></li><li><a href="#LaplaceRedux.LaplaceRegression"><code>LaplaceRedux.LaplaceRegression</code></a></li><li><a href="#LaplaceRedux.Posterior"><code>LaplaceRedux.Posterior</code></a></li><li><a href="#LaplaceRedux.Posterior-Tuple{Any, LaplaceRedux.EstimationParams}"><code>LaplaceRedux.Posterior</code></a></li><li><a href="#LaplaceRedux.Prior"><code>LaplaceRedux.Prior</code></a></li><li><a href="#LaplaceRedux.Prior-Tuple{LaplaceRedux.LaplaceParams, Any, Symbol}"><code>LaplaceRedux.Prior</code></a></li><li><a href="#Base.:*-Tuple{Real, LaplaceRedux.Kron}"><code>Base.:*</code></a></li><li><a href="#Base.:*-Tuple{LaplaceRedux.KronDecomposed, Number}"><code>Base.:*</code></a></li><li><a href="#Base.:+-Tuple{LaplaceRedux.KronDecomposed, LinearAlgebra.Diagonal}"><code>Base.:+</code></a></li><li><a href="#Base.:+-Tuple{LaplaceRedux.KronDecomposed, Number}"><code>Base.:+</code></a></li><li><a href="#Base.:+-Tuple{LaplaceRedux.Kron, LaplaceRedux.Kron}"><code>Base.:+</code></a></li><li><a href="#Base.:==-Tuple{LaplaceRedux.Kron, LaplaceRedux.Kron}"><code>Base.:==</code></a></li><li><a href="#Base.getindex-Tuple{LaplaceRedux.KronDecomposed, Int64}"><code>Base.getindex</code></a></li><li><a href="#Base.getindex-Tuple{LaplaceRedux.Kron, Int64}"><code>Base.getindex</code></a></li><li><a href="#Base.length-Tuple{LaplaceRedux.KronDecomposed}"><code>Base.length</code></a></li><li><a href="#Flux.params-Tuple{Any, LaplaceRedux.EstimationParams}"><code>Flux.params</code></a></li><li><a href="#Flux.params-Tuple{Laplace}"><code>Flux.params</code></a></li><li><a href="#LaplaceRedux.Curvature.full_batched-Tuple{LaplaceRedux.Curvature.GGN, Tuple}"><code>LaplaceRedux.Curvature.full_batched</code></a></li><li><a href="#LaplaceRedux.Curvature.full_batched-Tuple{LaplaceRedux.Curvature.EmpiricalFisher, Tuple}"><code>LaplaceRedux.Curvature.full_batched</code></a></li><li><a href="#LaplaceRedux.Curvature.full_unbatched-Tuple{LaplaceRedux.Curvature.EmpiricalFisher, Tuple}"><code>LaplaceRedux.Curvature.full_unbatched</code></a></li><li><a href="#LaplaceRedux.Curvature.full_unbatched-Tuple{LaplaceRedux.Curvature.GGN, Tuple}"><code>LaplaceRedux.Curvature.full_unbatched</code></a></li><li><a href="#LaplaceRedux.Curvature.gradients-Tuple{LaplaceRedux.Curvature.CurvatureInterface, AbstractArray, Union{Number, AbstractArray}}"><code>LaplaceRedux.Curvature.gradients</code></a></li><li><a href="#LaplaceRedux.Curvature.jacobians-Tuple{LaplaceRedux.Curvature.CurvatureInterface, AbstractArray}"><code>LaplaceRedux.Curvature.jacobians</code></a></li><li><a href="#LaplaceRedux.Curvature.jacobians_batched-Tuple{LaplaceRedux.Curvature.CurvatureInterface, AbstractArray}"><code>LaplaceRedux.Curvature.jacobians_batched</code></a></li><li><a href="#LaplaceRedux.Curvature.jacobians_unbatched-Tuple{LaplaceRedux.Curvature.CurvatureInterface, AbstractArray}"><code>LaplaceRedux.Curvature.jacobians_unbatched</code></a></li><li><a href="#LaplaceRedux.Data.toy_data_linear"><code>LaplaceRedux.Data.toy_data_linear</code></a></li><li><a href="#LaplaceRedux.Data.toy_data_multi"><code>LaplaceRedux.Data.toy_data_multi</code></a></li><li><a href="#LaplaceRedux.Data.toy_data_non_linear"><code>LaplaceRedux.Data.toy_data_non_linear</code></a></li><li><a href="#LaplaceRedux.Data.toy_data_regression"><code>LaplaceRedux.Data.toy_data_regression</code></a></li><li><a href="#LaplaceRedux._H_factor-Tuple{LaplaceRedux.AbstractLaplace}"><code>LaplaceRedux._H_factor</code></a></li><li><a href="#LaplaceRedux._fit!-Tuple{Laplace, LaplaceRedux.FullHessian, Any}"><code>LaplaceRedux._fit!</code></a></li><li><a href="#LaplaceRedux._fit!-Tuple{Laplace, LaplaceRedux.KronHessian, Any}"><code>LaplaceRedux._fit!</code></a></li><li><a href="#LaplaceRedux._init_H-Tuple{LaplaceRedux.AbstractLaplace}"><code>LaplaceRedux._init_H</code></a></li><li><a href="#LaplaceRedux._weight_penalty-Tuple{LaplaceRedux.AbstractLaplace}"><code>LaplaceRedux._weight_penalty</code></a></li><li><a href="#LaplaceRedux.approximate-Tuple{LaplaceRedux.Curvature.CurvatureInterface, LaplaceRedux.FullHessian, Tuple}"><code>LaplaceRedux.approximate</code></a></li><li><a href="#LaplaceRedux.approximate-Tuple{LaplaceRedux.Curvature.CurvatureInterface, LaplaceRedux.KronHessian, Any}"><code>LaplaceRedux.approximate</code></a></li><li><a href="#LaplaceRedux.clamp-Tuple{LinearAlgebra.Eigen}"><code>LaplaceRedux.clamp</code></a></li><li><a href="#LaplaceRedux.convert_subnetwork_indices-Tuple{Vector{Vector{Int64}}, AbstractArray}"><code>LaplaceRedux.convert_subnetwork_indices</code></a></li><li><a href="#LaplaceRedux.decompose-Tuple{LaplaceRedux.Kron}"><code>LaplaceRedux.decompose</code></a></li><li><a href="#LaplaceRedux.fit!-Tuple{LaplaceRedux.AbstractLaplace, Any}"><code>LaplaceRedux.fit!</code></a></li><li><a href="#LaplaceRedux.fit!-Tuple{LaplaceRedux.AbstractLaplace, MLUtils.DataLoader}"><code>LaplaceRedux.fit!</code></a></li><li><a href="#LaplaceRedux.functional_variance-Tuple{Laplace, LaplaceRedux.FullHessian, Any}"><code>LaplaceRedux.functional_variance</code></a></li><li><a href="#LaplaceRedux.functional_variance-Tuple{Any, Any}"><code>LaplaceRedux.functional_variance</code></a></li><li><a href="#LaplaceRedux.functional_variance-Tuple{Laplace, LaplaceRedux.KronHessian, Matrix}"><code>LaplaceRedux.functional_variance</code></a></li><li><a href="#LaplaceRedux.get_loss_fun-Tuple{Symbol, Flux.Chain}"><code>LaplaceRedux.get_loss_fun</code></a></li><li><a href="#LaplaceRedux.get_loss_type-Tuple{Symbol, Flux.Chain}"><code>LaplaceRedux.get_loss_type</code></a></li><li><a href="#LaplaceRedux.get_map_estimate-Tuple{Any, LaplaceRedux.EstimationParams}"><code>LaplaceRedux.get_map_estimate</code></a></li><li><a href="#LaplaceRedux.get_prior_mean-Tuple{Laplace}"><code>LaplaceRedux.get_prior_mean</code></a></li><li><a href="#LaplaceRedux.glm_predictive_distribution-Tuple{LaplaceRedux.AbstractLaplace, AbstractArray}"><code>LaplaceRedux.glm_predictive_distribution</code></a></li><li><a href="#LaplaceRedux.has_softmax_or_sigmoid_final_layer-Tuple{Flux.Chain}"><code>LaplaceRedux.has_softmax_or_sigmoid_final_layer</code></a></li><li><a href="#LaplaceRedux.hessian_approximation-Tuple{LaplaceRedux.AbstractLaplace, Any}"><code>LaplaceRedux.hessian_approximation</code></a></li><li><a href="#LaplaceRedux.instantiate_curvature!-Tuple{LaplaceRedux.EstimationParams, Any, Symbol, Symbol}"><code>LaplaceRedux.instantiate_curvature!</code></a></li><li><a href="#LaplaceRedux.interleave-Tuple"><code>LaplaceRedux.interleave</code></a></li><li><a href="#LaplaceRedux.inv_square_form-Tuple{LaplaceRedux.KronDecomposed, Matrix}"><code>LaplaceRedux.inv_square_form</code></a></li><li><a href="#LaplaceRedux.log_det_posterior_precision-Tuple{LaplaceRedux.AbstractLaplace}"><code>LaplaceRedux.log_det_posterior_precision</code></a></li><li><a href="#LaplaceRedux.log_det_prior_precision-Tuple{LaplaceRedux.AbstractLaplace}"><code>LaplaceRedux.log_det_prior_precision</code></a></li><li><a href="#LaplaceRedux.log_det_ratio-Tuple{LaplaceRedux.AbstractLaplace}"><code>LaplaceRedux.log_det_ratio</code></a></li><li><a href="#LaplaceRedux.log_likelihood-Tuple{LaplaceRedux.AbstractLaplace}"><code>LaplaceRedux.log_likelihood</code></a></li><li><a href="#LaplaceRedux.log_marginal_likelihood-Tuple{LaplaceRedux.AbstractLaplace}"><code>LaplaceRedux.log_marginal_likelihood</code></a></li><li><a href="#LaplaceRedux.logdetblock-Tuple{Tuple{LinearAlgebra.Eigen, LinearAlgebra.Eigen}, Number}"><code>LaplaceRedux.logdetblock</code></a></li><li><a href="#LaplaceRedux.mm-Tuple{LaplaceRedux.KronDecomposed, Any}"><code>LaplaceRedux.mm</code></a></li><li><a href="#LaplaceRedux.n_params-Tuple{Any, LaplaceRedux.EstimationParams}"><code>LaplaceRedux.n_params</code></a></li><li><a href="#LaplaceRedux.n_params-Tuple{Laplace}"><code>LaplaceRedux.n_params</code></a></li><li><a href="#LaplaceRedux.optimize_prior!-Tuple{LaplaceRedux.AbstractLaplace}"><code>LaplaceRedux.optimize_prior!</code></a></li><li><a href="#LaplaceRedux.outdim-Tuple{LaplaceRedux.AbstractLaplace}"><code>LaplaceRedux.outdim</code></a></li><li><a href="#LaplaceRedux.outdim-Tuple{Flux.Chain}"><code>LaplaceRedux.outdim</code></a></li><li><a href="#LaplaceRedux.posterior_covariance"><code>LaplaceRedux.posterior_covariance</code></a></li><li><a href="#LaplaceRedux.posterior_precision"><code>LaplaceRedux.posterior_precision</code></a></li><li><a href="#LaplaceRedux.predict-Tuple{LaplaceRedux.AbstractLaplace, AbstractArray}"><code>LaplaceRedux.predict</code></a></li><li><a href="#LaplaceRedux.prior_precision-Tuple{Laplace}"><code>LaplaceRedux.prior_precision</code></a></li><li><a href="#LaplaceRedux.probit-Tuple{AbstractArray, AbstractArray}"><code>LaplaceRedux.probit</code></a></li><li><a href="#LaplaceRedux.validate_subnetwork_indices-Tuple{Union{Nothing, Vector{Vector{Int64}}}, Any}"><code>LaplaceRedux.validate_subnetwork_indices</code></a></li><li><a href="#LinearAlgebra.det-Tuple{LaplaceRedux.KronDecomposed}"><code>LinearAlgebra.det</code></a></li><li><a href="#LinearAlgebra.logdet-Tuple{LaplaceRedux.KronDecomposed}"><code>LinearAlgebra.logdet</code></a></li><li><a href="#MLJFlux.build-Tuple{LaplaceClassification, Any, Any}"><code>MLJFlux.build</code></a></li><li><a href="#MLJFlux.build-Tuple{LaplaceRegression, Any, Any}"><code>MLJFlux.build</code></a></li><li><a href="#MLJFlux.fitresult-Tuple{LaplaceRegression, Any, Any}"><code>MLJFlux.fitresult</code></a></li><li><a href="#MLJFlux.fitresult-Tuple{LaplaceClassification, Any, Any}"><code>MLJFlux.fitresult</code></a></li><li><a href="#MLJFlux.shape-Tuple{LaplaceRegression, Any, Any}"><code>MLJFlux.shape</code></a></li><li><a href="#MLJFlux.train-Tuple{LaplaceClassification, Vararg{Any, 7}}"><code>MLJFlux.train</code></a></li><li><a href="#MLJFlux.train-Tuple{LaplaceRegression, Vararg{Any, 7}}"><code>MLJFlux.train</code></a></li><li><a href="#MLJModelInterface.predict-Tuple{LaplaceClassification, Any, Any}"><code>MLJModelInterface.predict</code></a></li><li><a href="#MLJModelInterface.predict-Tuple{LaplaceRegression, Any, Any}"><code>MLJModelInterface.predict</code></a></li><li><a href="#LaplaceRedux.@zb-Tuple{Any}"><code>LaplaceRedux.@zb</code></a></li></ul><h2 id="Exported-functions"><a class="docs-heading-anchor" href="#Exported-functions">Exported functions</a><a id="Exported-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Exported-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.Laplace" href="#LaplaceRedux.Laplace"><code>LaplaceRedux.Laplace</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Laplace</code></pre><p>Concrete type for Laplace approximation. This type is a subtype of <code>AbstractLaplace</code> and is used to store all the necessary information for a Laplace approximation.</p><p><strong>Fields</strong></p><ul><li><code>model::Flux.Chain</code>: The model to be approximated.</li><li><code>likelihood::Symbol</code>: The likelihood function to be used.</li><li><code>est_params::</code><a href="#LaplaceRedux.EstimationParams"><code>EstimationParams</code></a>: The estimation parameters.</li><li><code>prior::</code><a href="#LaplaceRedux.Prior"><code>Prior</code></a>: The parameters defining prior distribution.</li><li><code>posterior::</code><a href="#LaplaceRedux.Posterior"><code>Posterior</code></a>: The posterior distribution.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/core_struct.jl#L50-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.Laplace-Tuple{Any}" href="#LaplaceRedux.Laplace-Tuple{Any}"><code>LaplaceRedux.Laplace</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Laplace(model::Any; likelihood::Symbol, kwargs...)</code></pre><p>Outer constructor for Laplace approximation. This function constructs a Laplace object from a given model and likelihood function.</p><p><strong>Arguments</strong></p><ul><li><code>model::Any</code>: The model to be approximated (a Flux.Chain).</li><li><code>likelihood::Symbol</code>: The likelihood function to be used. Possible values are <code>:regression</code> and <code>:classification</code>.</li></ul><p><strong>Keyword Arguments</strong></p><p>See <a href="#LaplaceRedux.LaplaceParams"><code>LaplaceParams</code></a> for a description of the keyword arguments.</p><p><strong>Returns</strong></p><ul><li><code>la::Laplace</code>: The Laplace object.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using Flux, LaplaceRedux
nn = Chain(Dense(2,1))
la = Laplace(nn, likelihood=:regression)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/core_struct.jl#L71-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.LaplaceClassification" href="#LaplaceRedux.LaplaceClassification"><code>LaplaceRedux.LaplaceClassification</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">MLJBase.@mlj_model mutable struct LaplaceClassification &lt;: MLJFlux.MLJFluxProbabilistic</code></pre><p>A mutable struct representing a Laplace Classification model that extends the MLJFluxProbabilistic abstract type. It uses Laplace approximation to estimate the posterior distribution of the weights of a neural network. </p><p>The model is defined by the following default parameters for all <code>MLJFlux</code> models:</p><ul><li><code>builder</code>: a Flux model that constructs the neural network.</li><li><code>finaliser</code>: a Flux model that processes the output of the neural network.</li><li><code>optimiser</code>: a Flux optimiser.</li><li><code>loss</code>: a loss function that takes the predicted output and the true output as arguments.</li><li><code>epochs</code>: the number of epochs.</li><li><code>batch_size</code>: the size of a batch.</li><li><code>lambda</code>: the regularization strength.</li><li><code>alpha</code>: the regularization mix (0 for all l2, 1 for all l1).</li><li><code>rng</code>: a random number generator.</li><li><code>optimiser_changes_trigger_retraining</code>: a boolean indicating whether changes in the optimiser trigger retraining.</li><li><code>acceleration</code>: the computational resource to use.</li></ul><p>The model also has the following parameters, which are specific to the Laplace approximation:</p><ul><li><code>subset_of_weights</code>: the subset of weights to use, either <code>:all</code>, <code>:last_layer</code>, or <code>:subnetwork</code>.</li><li><code>subnetwork_indices</code>: the indices of the subnetworks.</li><li><code>hessian_structure</code>: the structure of the Hessian matrix, either <code>:full</code> or <code>:diagonal</code>.</li><li><code>backend</code>: the backend to use, either <code>:GGN</code> or <code>:EmpiricalFisher</code>.</li><li><code>œÉ</code>: the standard deviation of the prior distribution.</li><li><code>Œº‚ÇÄ</code>: the mean of the prior distribution.</li><li><code>P‚ÇÄ</code>: the covariance matrix of the prior distribution.</li><li><code>link_approx</code>: the link approximation to use, either <code>:probit</code> or <code>:plugin</code>.</li><li><code>predict_proba</code>: a boolean that select whether to predict probabilities or not.</li><li><code>ret_distr</code>: a boolean that tells predict to either return distributions (true) objects from Distributions.jl or just the probabilities.</li><li><code>fit_prior_nsteps</code>: the number of steps used to fit the priors.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/mlj_flux.jl#L67-L99">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.LaplaceRegression" href="#LaplaceRedux.LaplaceRegression"><code>LaplaceRedux.LaplaceRegression</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">MLJBase.@mlj_model mutable struct LaplaceRegression &lt;: MLJFlux.MLJFluxProbabilistic</code></pre><p>A mutable struct representing a Laplace regression model that extends the <code>MLJFlux.MLJFluxProbabilistic</code> abstract type. It uses Laplace approximation to estimate the posterior distribution of the weights of a neural network. </p><p>The model is defined by the following default parameters for all <code>MLJFlux</code> models:</p><ul><li><code>builder</code>: a Flux model that constructs the neural network.</li><li><code>optimiser</code>: a Flux optimiser.</li><li><code>loss</code>: a loss function that takes the predicted output and the true output as arguments.</li><li><code>epochs</code>: the number of epochs.</li><li><code>batch_size</code>: the size of a batch.</li><li><code>lambda</code>: the regularization strength.</li><li><code>alpha</code>: the regularization mix (0 for all l2, 1 for all l1).</li><li><code>rng</code>: a random number generator.</li><li><code>optimiser_changes_trigger_retraining</code>: a boolean indicating whether changes in the optimiser trigger retraining.</li><li><code>acceleration</code>: the computational resource to use.</li></ul><p>The model also has the following parameters, which are specific to the Laplace approximation:</p><ul><li><code>subset_of_weights</code>: the subset of weights to use, either <code>:all</code>, <code>:last_layer</code>, or <code>:subnetwork</code>.</li><li><code>subnetwork_indices</code>: the indices of the subnetworks.</li><li><code>hessian_structure</code>: the structure of the Hessian matrix, either <code>:full</code> or <code>:diagonal</code>.</li><li><code>backend</code>: the backend to use, either <code>:GGN</code> or <code>:EmpiricalFisher</code>.</li><li><code>œÉ</code>: the standard deviation of the prior distribution.</li><li><code>Œº‚ÇÄ</code>: the mean of the prior distribution.</li><li><code>P‚ÇÄ</code>: the covariance matrix of the prior distribution.</li><li><code>ret_distr</code>: a boolean that tells predict to either return distributions (true) objects from Distributions.jl or just the probabilities.</li><li><code>fit_prior_nsteps</code>: the number of steps used to fit the priors.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/mlj_flux.jl#L13-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.fit!-Tuple{LaplaceRedux.AbstractLaplace, Any}" href="#LaplaceRedux.fit!-Tuple{LaplaceRedux.AbstractLaplace, Any}"><code>LaplaceRedux.fit!</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fit!(la::AbstractLaplace,data)</code></pre><p>Fits the Laplace approximation for a data set. The function returns the number of observations (n_data) that were used to update the Laplace object. It does not return the updated Laplace object itself because the function modifies the input Laplace object in place (as denoted by the use of &#39;!&#39; in the function&#39;s name).</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">using Flux, LaplaceRedux
x, y = LaplaceRedux.Data.toy_data_linear()
data = zip(x,y)
nn = Chain(Dense(2,1))
la = Laplace(nn)
fit!(la, data)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/fitting.jl#L13-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.fit!-Tuple{LaplaceRedux.AbstractLaplace, MLUtils.DataLoader}" href="#LaplaceRedux.fit!-Tuple{LaplaceRedux.AbstractLaplace, MLUtils.DataLoader}"><code>LaplaceRedux.fit!</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><p>Fit the Laplace approximation, with batched data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/fitting.jl#L43-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.glm_predictive_distribution-Tuple{LaplaceRedux.AbstractLaplace, AbstractArray}" href="#LaplaceRedux.glm_predictive_distribution-Tuple{LaplaceRedux.AbstractLaplace, AbstractArray}"><code>LaplaceRedux.glm_predictive_distribution</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">glm_predictive_distribution(la::AbstractLaplace, X::AbstractArray)</code></pre><p>Computes the linearized GLM predictive.</p><p><strong>Arguments</strong></p><ul><li><code>la::AbstractLaplace</code>: A Laplace object.</li><li><code>X::AbstractArray</code>: Input data.</li></ul><p><strong>Returns</strong></p><ul><li><code>normal_distr</code> A normal distribution N(fŒº,fvar) approximating the predictive distribution p(y|X) given the input data X.</li><li><code>fŒº::AbstractArray</code>: Mean of the predictive distribution. The output shape is column-major as in Flux.</li><li><code>fvar::AbstractArray</code>: Variance of the predictive distribution. The output shape is column-major as in Flux.</li></ul><p><strong>Examples</strong></p><p>```julia-repl using Flux, LaplaceRedux using LaplaceRedux.Data: toy<em>data</em>linear x, y = toy<em>data</em>linear() data = zip(x,y) nn = Chain(Dense(2,1)) la = Laplace(nn; likelihood=:classification) fit!(la, data) glm<em>predictive</em>distribution(la, hcat(x...))</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/predicting.jl#L35-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.optimize_prior!-Tuple{LaplaceRedux.AbstractLaplace}" href="#LaplaceRedux.optimize_prior!-Tuple{LaplaceRedux.AbstractLaplace}"><code>LaplaceRedux.optimize_prior!</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">optimize_prior!(
    la::AbstractLaplace; 
    n_steps::Int=100, lr::Real=1e-1,
    Œªinit::Union{Nothing,Real}=nothing,
    œÉinit::Union{Nothing,Real}=nothing
)</code></pre><p>Optimize the prior precision post-hoc through Empirical Bayes (marginal log-likelihood maximization).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/optimize_prior.jl#L1-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.posterior_covariance" href="#LaplaceRedux.posterior_covariance"><code>LaplaceRedux.posterior_covariance</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">posterior_covariance(la::AbstractLaplace, P=la.P)</code></pre><p>Computes the posterior covariance <span>$‚àë$</span> as the inverse of the posterior precision: <span>$\Sigma=P^{-1}$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/utils.jl#L55-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.posterior_precision" href="#LaplaceRedux.posterior_precision"><code>LaplaceRedux.posterior_precision</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">posterior_precision(la::AbstractLaplace, H=la.posterior.H, P‚ÇÄ=la.prior.P‚ÇÄ)</code></pre><p>Computes the posterior precision <span>$P$</span> for a fitted Laplace Approximation as follows,</p><p><span>$P = \sum_{n=1}^N\nabla_{\theta}^2 \log p(\mathcal{D}_n|\theta)|_{\hat\theta} + \nabla_{\theta}^2 \log p(\theta)|_{\hat\theta}$</span></p><p>where <span>$\sum_{n=1}^N\nabla_{\theta}^2\log p(\mathcal{D}_n|\theta)|_{\hat\theta}=H$</span> is the Hessian and <span>$\nabla_{\theta}^2 \log p(\theta)|_{\hat\theta}=P_0$</span> is the prior precision and <span>$\hat\theta$</span> is the MAP estimate.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/utils.jl#L41-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.predict-Tuple{LaplaceRedux.AbstractLaplace, AbstractArray}" href="#LaplaceRedux.predict-Tuple{LaplaceRedux.AbstractLaplace, AbstractArray}"><code>LaplaceRedux.predict</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">predict(la::AbstractLaplace, X::AbstractArray; link_approx=:probit, predict_proba::Bool=true)</code></pre><p>Computes predictions from Bayesian neural network.</p><p><strong>Arguments</strong></p><ul><li><code>la::AbstractLaplace</code>: A Laplace object.</li><li><code>X::AbstractArray</code>: Input data.</li><li><code>link_approx::Symbol=:probit</code>: Link function approximation. Options are <code>:probit</code> and <code>:plugin</code>.</li><li><code>predict_proba::Bool=true</code>: If <code>true</code> (default) apply a sigmoid or a softmax function to the output of the Flux model.</li><li><code>return_distr::Bool=false</code>: if <code>false</code> (default), the function output either the direct output of the chain or pseudo-probabilities (if predict_proba= true).   if <code>true</code> predict return a Bernoulli distribution in binary classification tasks and a categorical distribution in multiclassification tasks.</li></ul><p><strong>Returns</strong></p><p>For classification tasks, LaplaceRedux provides different options: if ret<em>distr is false:     - <code>fŒº::AbstractArray</code>: Mean of the predictive distribution if link function is set to <code>:plugin</code>, otherwise the probit approximation. The output shape is column-major as in Flux. if ret</em>distr is true:     - a Bernoulli distribution in binary classification tasks and a categorical distribution in multiclassification tasks. For regression tasks:</p><ul><li><code>normal_distr::Distributions.Normal</code>:the array of Normal distributions computed by glm<em>predictive</em>distribution. </li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">using Flux, LaplaceRedux
using LaplaceRedux.Data: toy_data_linear
x, y = toy_data_linear()
data = zip(x,y)
nn = Chain(Dense(2,1))
la = Laplace(nn; likelihood=:classification)
fit!(la, data)
predict(la, hcat(x...))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/predicting.jl#L72-L106">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLJModelInterface.predict-Tuple{LaplaceClassification, Any, Any}" href="#MLJModelInterface.predict-Tuple{LaplaceClassification, Any, Any}"><code>MLJModelInterface.predict</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">predict(model::LaplaceClassification, Xnew)</code></pre><p>Predicts the class labels for new data using the LaplaceClassification model.</p><p><strong>Arguments</strong></p><ul><li><code>model::LaplaceClassification</code>: The trained LaplaceClassification model.</li><li>fitresult: the fitresult output produced by MLJFlux.fit!</li><li><code>Xnew</code>: The new data to make predictions on.</li></ul><p><strong>Returns</strong></p><p>An array of predicted class labels.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/mlj_flux.jl#L442-L455">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLJModelInterface.predict-Tuple{LaplaceRegression, Any, Any}" href="#MLJModelInterface.predict-Tuple{LaplaceRegression, Any, Any}"><code>MLJModelInterface.predict</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">predict(model::LaplaceRegression, Xnew)</code></pre><p>Predict the output for new input data using a Laplace regression model.</p><p><strong>Arguments</strong></p><ul><li><code>model::LaplaceRegression</code>: The trained Laplace regression model.</li><li>the fitresult output produced by MLJFlux.fit!</li><li><code>Xnew</code>: The new input data.</li></ul><p><strong>Returns</strong></p><ul><li>The predicted output for the new input data.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/mlj_flux.jl#L273-L286">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.Curvature.CurvatureInterface" href="#LaplaceRedux.Curvature.CurvatureInterface"><code>LaplaceRedux.Curvature.CurvatureInterface</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><p>Base type for any curvature interface.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/curvature/Curvature.jl#L12">source</a></section></article><h2 id="Internal-functions"><a class="docs-heading-anchor" href="#Internal-functions">Internal functions</a><a id="Internal-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Internal-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.AbstractDecomposition" href="#LaplaceRedux.AbstractDecomposition"><code>LaplaceRedux.AbstractDecomposition</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><p>Abstract type of Hessian decompositions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/core_struct.jl#L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.AbstractLaplace" href="#LaplaceRedux.AbstractLaplace"><code>LaplaceRedux.AbstractLaplace</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><p>Abstract base type for all Laplace approximations in this library. All subclasses implemented are parametric.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/core_struct.jl#L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.AbstractLaplace-Tuple{AbstractArray}" href="#LaplaceRedux.AbstractLaplace-Tuple{AbstractArray}"><code>LaplaceRedux.AbstractLaplace</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">(la::AbstractLaplace)(X::AbstractArray)</code></pre><p>Calling a model with Laplace Approximation on an array of inputs is equivalent to explicitly calling the <code>predict</code> function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/predicting.jl#L192-L196">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.EstimationParams" href="#LaplaceRedux.EstimationParams"><code>LaplaceRedux.EstimationParams</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">EstimationParams</code></pre><p>Container for the parameters of a Laplace approximation. </p><p><strong>Fields</strong></p><ul><li><code>subset_of_weights::Symbol</code>: the subset of weights to consider. Possible values are <code>:all</code>, <code>:last_layer</code>, and <code>:subnetwork</code>.</li><li><code>subnetwork_indices::Union{Nothing,Vector{Vector{Int}}}</code>: the indices of the subnetwork. Possible values are <code>nothing</code> or a vector of vectors of integers.</li><li><code>hessian_structure::HessianStructure</code>: the structure of the Hessian. Possible values are <code>:full</code> and <code>:kron</code> or a concrete subtype of <code>HessianStructure</code>.</li><li><code>curvature::Union{Curvature.CurvatureInterface,Nothing}</code>: the curvature interface. Possible values are <code>nothing</code> or a concrete subtype of <code>CurvatureInterface</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/estimation_params.jl#L1-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.EstimationParams-Tuple{LaplaceRedux.LaplaceParams, Any, Symbol}" href="#LaplaceRedux.EstimationParams-Tuple{LaplaceRedux.LaplaceParams, Any, Symbol}"><code>LaplaceRedux.EstimationParams</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">EstimationParams(params::LaplaceParams)</code></pre><p>Extracts the estimation parameters from a <code>LaplaceParams</code> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/estimation_params.jl#L20-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.FullHessian" href="#LaplaceRedux.FullHessian"><code>LaplaceRedux.FullHessian</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><p>Concrete type for full Hessian structure. This is the default structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/core_struct.jl#L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.HessianStructure" href="#LaplaceRedux.HessianStructure"><code>LaplaceRedux.HessianStructure</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><p>Abstract type for Hessian structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/core_struct.jl#L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.Kron" href="#LaplaceRedux.Kron"><code>LaplaceRedux.Kron</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><p>Kronecker-factored approximate curvature representation for a neural network model. Each element in kfacs represents two Kronecker factors (ùêÜ, ùêÄ), such that the full block Hessian approximation would be approximated as ùêÄ‚äóùêÜ.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/kronecker/utils.jl#L16-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.KronDecomposed" href="#LaplaceRedux.KronDecomposed"><code>LaplaceRedux.KronDecomposed</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">KronDecomposed</code></pre><p>Decomposed Kronecker-factored approximate curvature representation for a neural network model.</p><p>Decomposition is required to add the prior (diagonal matrix) to the posterior (<code>KronDecomposed</code>). It also has the benefits of reducing the costs for computation of inverses and log-determinants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/kronecker/utils.jl#L67-L74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.KronHessian" href="#LaplaceRedux.KronHessian"><code>LaplaceRedux.KronHessian</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><p>Concrete type for Kronecker-factored Hessian structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/kronecker/kron.jl#L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.LaplaceParams" href="#LaplaceRedux.LaplaceParams"><code>LaplaceRedux.LaplaceParams</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LaplaceParams</code></pre><p>Container for the parameters of a Laplace approximation.</p><p><strong>Fields</strong></p><ul><li><code>subset_of_weights::Symbol</code>: the subset of weights to consider. Possible values are <code>:all</code>, <code>:last_layer</code>, and <code>:subnetwork</code>.</li><li><code>subnetwork_indices::Union{Nothing,Vector{Vector{Int}}}</code>: the indices of the subnetwork. Possible values are <code>nothing</code> or a vector of vectors of integers.</li><li><code>hessian_structure::HessianStructure</code>: the structure of the Hessian. Possible values are <code>:full</code> and <code>:kron</code> or a concrete subtype of <code>HessianStructure</code>.</li><li><code>backend::Symbol</code>: the backend to use. Possible values are <code>:GGN</code> and <code>:Fisher</code>.</li><li><code>curvature::Union{Curvature.CurvatureInterface,Nothing}</code>: the curvature interface. Possible values are <code>nothing</code> or a concrete subtype of <code>CurvatureInterface</code>.</li><li><code>œÉ::Real</code>: the observation noise</li><li><code>Œº‚ÇÄ::Real</code>: the prior mean</li><li><code>Œª::Real</code>: the prior precision</li><li><code>P‚ÇÄ::Union{Nothing,AbstractMatrix,UniformScaling}</code>: the prior precision matrix</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/core_struct.jl#L17-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.Posterior" href="#LaplaceRedux.Posterior"><code>LaplaceRedux.Posterior</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Posterior</code></pre><p>Container for the results of a Laplace approximation.</p><p><strong>Fields</strong></p><ul><li><code>Œº::AbstractVector</code>: the MAP estimate of the parameters</li><li><code>H::Union{AbstractArray,AbstractDecomposition,Nothing}</code>: the Hessian matrix</li><li><code>P::Union{AbstractArray,AbstractDecomposition,Nothing}</code>: the posterior precision matrix</li><li><code>Œ£::Union{AbstractArray,Nothing}</code>: the posterior covariance matrix</li><li><code>n_data::Union{Int,Nothing}</code>: the number of data points</li><li><code>n_params::Union{Int,Nothing}</code>: the number of parameters</li><li><code>n_out::Union{Int,Nothing}</code>: the number of outputs</li><li><code>loss::Real</code>: the loss value</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/posterior.jl#L1-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.Posterior-Tuple{Any, LaplaceRedux.EstimationParams}" href="#LaplaceRedux.Posterior-Tuple{Any, LaplaceRedux.EstimationParams}"><code>LaplaceRedux.Posterior</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Posterior(model::Any, est_params::EstimationParams)</code></pre><p>Outer constructor for <code>Posterior</code> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/posterior.jl#L28-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.Prior" href="#LaplaceRedux.Prior"><code>LaplaceRedux.Prior</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Prior</code></pre><p>Container for the prior parameters of a Laplace approximation.</p><p><strong>Fields</strong></p><ul><li><code>œÉ::Real</code>: the observation noise</li><li><code>Œº‚ÇÄ::Real</code>: the prior mean</li><li><code>Œª::Real</code>: the prior precision</li><li><code>P‚ÇÄ::Union{Nothing,AbstractMatrix,UniformScaling}</code>: the prior precision matrix</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/prior.jl#L1-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.Prior-Tuple{LaplaceRedux.LaplaceParams, Any, Symbol}" href="#LaplaceRedux.Prior-Tuple{LaplaceRedux.LaplaceParams, Any, Symbol}"><code>LaplaceRedux.Prior</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Prior(params::LaplaceParams)</code></pre><p>Extracts the prior parameters from a <code>LaplaceParams</code> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/prior.jl#L20-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Tuple{LaplaceRedux.KronDecomposed, Number}" href="#Base.:*-Tuple{LaplaceRedux.KronDecomposed, Number}"><code>Base.:*</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><p>Multiply by a scalar by changing the eigenvalues. Distribute the scalar along the factors of a block.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/kronecker/utils.jl#L117-L119">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:*-Tuple{Real, LaplaceRedux.Kron}" href="#Base.:*-Tuple{Real, LaplaceRedux.Kron}"><code>Base.:*</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><p>Kronecker-factored curvature scalar scaling.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/kronecker/utils.jl#L42-L44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:+-Tuple{LaplaceRedux.Kron, LaplaceRedux.Kron}" href="#Base.:+-Tuple{LaplaceRedux.Kron, LaplaceRedux.Kron}"><code>Base.:+</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><p>Kronecker-factored curvature sum.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/kronecker/utils.jl#L24-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:+-Tuple{LaplaceRedux.KronDecomposed, LinearAlgebra.Diagonal}" href="#Base.:+-Tuple{LaplaceRedux.KronDecomposed, LinearAlgebra.Diagonal}"><code>Base.:+</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><p>Shift the factors by a diagonal (assumed uniform scaling)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/kronecker/utils.jl#L110-L112">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:+-Tuple{LaplaceRedux.KronDecomposed, Number}" href="#Base.:+-Tuple{LaplaceRedux.KronDecomposed, Number}"><code>Base.:+</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><p>Shift the factors by a scalar across the diagonal.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/kronecker/utils.jl#L103-L105">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.:==-Tuple{LaplaceRedux.Kron, LaplaceRedux.Kron}" href="#Base.:==-Tuple{LaplaceRedux.Kron, LaplaceRedux.Kron}"><code>Base.:==</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><p>Kronecker-factored curvature equality.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/kronecker/utils.jl#L35-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.getindex-Tuple{LaplaceRedux.Kron, Int64}" href="#Base.getindex-Tuple{LaplaceRedux.Kron, Int64}"><code>Base.getindex</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><p>Get Kronecker-factored block represenation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/kronecker/utils.jl#L53-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.getindex-Tuple{LaplaceRedux.KronDecomposed, Int64}" href="#Base.getindex-Tuple{LaplaceRedux.KronDecomposed, Int64}"><code>Base.getindex</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><p>Get i-th block of a a Kronecker-factored curvature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/kronecker/utils.jl#L138-L140">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.length-Tuple{LaplaceRedux.KronDecomposed}" href="#Base.length-Tuple{LaplaceRedux.KronDecomposed}"><code>Base.length</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><p>Number of blocks in a Kronecker-factored curvature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/kronecker/utils.jl#L131-L133">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Flux.params-Tuple{Any, LaplaceRedux.EstimationParams}" href="#Flux.params-Tuple{Any, LaplaceRedux.EstimationParams}"><code>Flux.params</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Flux.params(model::Any, params::EstimationParams)</code></pre><p>Extracts the parameters of a model based on the subset of weights specified in the <code>EstimationParams</code> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/estimation_params.jl#L53-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Flux.params-Tuple{Laplace}" href="#Flux.params-Tuple{Laplace}"><code>Flux.params</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Flux.params(la::Laplace)</code></pre><p>Overloads the <code>params</code> function for a <code>Laplace</code> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/utils.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux._H_factor-Tuple{LaplaceRedux.AbstractLaplace}" href="#LaplaceRedux._H_factor-Tuple{LaplaceRedux.AbstractLaplace}"><code>LaplaceRedux._H_factor</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">_H_factor(la::AbstractLaplace)</code></pre><p>Returns the factor œÉ‚Åª¬≤, where œÉ is used in the zero-centered Gaussian prior p(Œ∏) = N(Œ∏;0,œÉ¬≤I)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/utils.jl#L80-L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux._fit!-Tuple{Laplace, LaplaceRedux.FullHessian, Any}" href="#LaplaceRedux._fit!-Tuple{Laplace, LaplaceRedux.FullHessian, Any}"><code>LaplaceRedux._fit!</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">_fit!(la::Laplace, hessian_structure::FullHessian, data; batched::Bool=false, batchsize::Int, override::Bool=true)</code></pre><p>Fit a Laplace approximation to the posterior distribution of a model using the full Hessian.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/full.jl#L19-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux._fit!-Tuple{Laplace, LaplaceRedux.KronHessian, Any}" href="#LaplaceRedux._fit!-Tuple{Laplace, LaplaceRedux.KronHessian, Any}"><code>LaplaceRedux._fit!</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">_fit!(la::Laplace, hessian_structure::KronHessian, data; batched::Bool=false, batchsize::Int, override::Bool=true)</code></pre><p>Fit a Laplace approximation to the posterior distribution of a model using the Kronecker-factored Hessian.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/kronecker/kron.jl#L102-L106">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux._init_H-Tuple{LaplaceRedux.AbstractLaplace}" href="#LaplaceRedux._init_H-Tuple{LaplaceRedux.AbstractLaplace}"><code>LaplaceRedux._init_H</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">_init_H(la::AbstractLaplace)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/utils.jl#L87-L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux._weight_penalty-Tuple{LaplaceRedux.AbstractLaplace}" href="#LaplaceRedux._weight_penalty-Tuple{LaplaceRedux.AbstractLaplace}"><code>LaplaceRedux._weight_penalty</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">_weight_penalty(la::AbstractLaplace)</code></pre><p>The weight penalty term is a regularization term used to prevent overfitting. Weight regularization methods such as weight decay introduce a penalty to the loss function when training a neural network to encourage the network to use small weights. Smaller weights in a neural network can result in a model that is more stable and less likely to overfit the training dataset, in turn having better performance when  making a prediction on new data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/utils.jl#L94-L101">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.approximate-Tuple{LaplaceRedux.Curvature.CurvatureInterface, LaplaceRedux.FullHessian, Tuple}" href="#LaplaceRedux.approximate-Tuple{LaplaceRedux.Curvature.CurvatureInterface, LaplaceRedux.FullHessian, Tuple}"><code>LaplaceRedux.approximate</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">approximate(curvature::CurvatureInterface, hessian_structure::FullHessian, d::Tuple; batched::Bool=false)</code></pre><p>Compute the full approximation, for either a single input-output datapoint or a batch of such. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/full.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.approximate-Tuple{LaplaceRedux.Curvature.CurvatureInterface, LaplaceRedux.KronHessian, Any}" href="#LaplaceRedux.approximate-Tuple{LaplaceRedux.Curvature.CurvatureInterface, LaplaceRedux.KronHessian, Any}"><code>LaplaceRedux.approximate</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">approximate(curvature::CurvatureInterface, hessian_structure::KronHessian, data; batched::Bool=false)</code></pre><p>Compute the eigendecomposed Kronecker-factored approximate curvature as the Fisher information matrix.</p><p>Note, since the network predictive distribution is used in a weighted sum, and the number of backward passes is linear in the number of target classes, e.g. 100 for CIFAR-100.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/kronecker/kron.jl#L6-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.clamp-Tuple{LinearAlgebra.Eigen}" href="#LaplaceRedux.clamp-Tuple{LinearAlgebra.Eigen}"><code>LaplaceRedux.clamp</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><p>Clamp eigenvalues in an eigendecomposition to be non-negative.</p><p>Since the Fisher information matrix is a positive-semidefinite by construction, the (near-zero) negative eigenvalues should be neglected.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/kronecker/utils.jl#L83-L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.convert_subnetwork_indices-Tuple{Vector{Vector{Int64}}, AbstractArray}" href="#LaplaceRedux.convert_subnetwork_indices-Tuple{Vector{Vector{Int64}}, AbstractArray}"><code>LaplaceRedux.convert_subnetwork_indices</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><p>convert<em>subnetwork</em>indices(subnetwork_indices::AbstractArray)</p><p>Converts the subnetwork indices from the user given format [theta, row, column] to an Int i that corresponds to the index of that weight in the flattened array of weights.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/subnet.jl#L30-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.decompose-Tuple{LaplaceRedux.Kron}" href="#LaplaceRedux.decompose-Tuple{LaplaceRedux.Kron}"><code>LaplaceRedux.decompose</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">decompose(K::Kron)</code></pre><p>Eigendecompose Kronecker factors and turn into <code>KronDecomposed</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/kronecker/utils.jl#L93-L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.functional_variance-Tuple{Any, Any}" href="#LaplaceRedux.functional_variance-Tuple{Any, Any}"><code>LaplaceRedux.functional_variance</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">functional_variance(la::AbstractLaplace, ùêâ::AbstractArray)</code></pre><p>Compute the functional variance for the GLM predictive. Dispatches to the appropriate method based on the Hessian structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/predicting.jl#L26-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.functional_variance-Tuple{Laplace, LaplaceRedux.FullHessian, Any}" href="#LaplaceRedux.functional_variance-Tuple{Laplace, LaplaceRedux.FullHessian, Any}"><code>LaplaceRedux.functional_variance</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><p>functional_variance(la::Laplace,ùêâ)</p><p>Compute the linearized GLM predictive variance as <code>ùêâ‚ÇôŒ£ùêâ‚Çô&#39;</code> where <code>ùêâ=‚àáf(x;Œ∏)|Œ∏ÃÇ</code> is the Jacobian evaluated at the MAP estimate and <code>Œ£ = P‚Åª¬π</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/full.jl#L53-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.functional_variance-Tuple{Laplace, LaplaceRedux.KronHessian, Matrix}" href="#LaplaceRedux.functional_variance-Tuple{Laplace, LaplaceRedux.KronHessian, Matrix}"><code>LaplaceRedux.functional_variance</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><p>functional<em>variance(la::Laplace, hessian</em>structure::KronHessian, ùêâ::Matrix)</p><p>Compute functional variance for the GLM predictive: as the diagonal of the K√óK predictive output covariance matrix ùêâùêè‚Åª¬πùêâ·µÄ, where K is the number of outputs, ùêè is the posterior precision, and ùêâ is the Jacobian of model output <code>ùêâ=‚àáf(x;Œ∏)|Œ∏ÃÇ</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/kronecker/kron.jl#L135-L140">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.get_loss_fun-Tuple{Symbol, Flux.Chain}" href="#LaplaceRedux.get_loss_fun-Tuple{Symbol, Flux.Chain}"><code>LaplaceRedux.get_loss_fun</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_loss_fun(likelihood::Symbol)</code></pre><p>Helper function to choose loss function based on specified model <code>likelihood</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/utils.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.get_loss_type-Tuple{Symbol, Flux.Chain}" href="#LaplaceRedux.get_loss_type-Tuple{Symbol, Flux.Chain}"><code>LaplaceRedux.get_loss_type</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_loss_type(likelihood::Symbol)</code></pre><p>Choose loss function type based on specified model <code>likelihood</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/utils.jl#L15-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.get_map_estimate-Tuple{Any, LaplaceRedux.EstimationParams}" href="#LaplaceRedux.get_map_estimate-Tuple{Any, LaplaceRedux.EstimationParams}"><code>LaplaceRedux.get_map_estimate</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_map_estimate(model::Any, est_params::EstimationParams)</code></pre><p>Helper function to extract the MAP estimate of the parameters for the model based on the subset of weights specified in the <code>EstimationParams</code> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/estimation_params.jl#L87-L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.get_prior_mean-Tuple{Laplace}" href="#LaplaceRedux.get_prior_mean-Tuple{Laplace}"><code>LaplaceRedux.get_prior_mean</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_prior_mean(la::Laplace)</code></pre><p>Helper function to extract the prior mean of the parameters from a Laplace approximation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/utils.jl#L15-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.has_softmax_or_sigmoid_final_layer-Tuple{Flux.Chain}" href="#LaplaceRedux.has_softmax_or_sigmoid_final_layer-Tuple{Flux.Chain}"><code>LaplaceRedux.has_softmax_or_sigmoid_final_layer</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">has_softmax_or_sigmoid_final_layer(model::Flux.Chain)</code></pre><p>Check if the FLux model ends with a sigmoid or with a softmax layer</p><p>Input:     - <code>model</code>: the Flux Chain object that represent the neural network. Return:     - <code>has_finaliser</code>: true if the check is positive, false otherwise.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/predicting.jl#L5-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.hessian_approximation-Tuple{LaplaceRedux.AbstractLaplace, Any}" href="#LaplaceRedux.hessian_approximation-Tuple{LaplaceRedux.AbstractLaplace, Any}"><code>LaplaceRedux.hessian_approximation</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">hessian_approximation(la::AbstractLaplace, d; batched::Bool=false)</code></pre><p>Computes the local Hessian approximation at a single datapoint <code>d</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/fitting.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.instantiate_curvature!-Tuple{LaplaceRedux.EstimationParams, Any, Symbol, Symbol}" href="#LaplaceRedux.instantiate_curvature!-Tuple{LaplaceRedux.EstimationParams, Any, Symbol, Symbol}"><code>LaplaceRedux.instantiate_curvature!</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">instantiate_curvature!(params::EstimationParams, model::Any, likelihood::Symbol, backend::Symbol)</code></pre><p>Instantiates the curvature interface for a Laplace approximation. The curvature interface is a concrete subtype of <a href="#LaplaceRedux.Curvature.CurvatureInterface"><code>CurvatureInterface</code></a> and is used to compute the Hessian matrix. The curvature interface is stored in the <code>curvature</code> field of the <code>EstimationParams</code> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/estimation_params.jl#L97-L101">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.interleave-Tuple" href="#LaplaceRedux.interleave-Tuple"><code>LaplaceRedux.interleave</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><p>Interleave elements of multiple iterables in order provided.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/kronecker/utils.jl#L60-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.inv_square_form-Tuple{LaplaceRedux.KronDecomposed, Matrix}" href="#LaplaceRedux.inv_square_form-Tuple{LaplaceRedux.KronDecomposed, Matrix}"><code>LaplaceRedux.inv_square_form</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><p>function inv<em>square</em>form(K::KronDecomposed, W::Matrix)</p><p>Special function to compute the inverse square form ùêâùêè‚Åª¬πùêâ·µÄ (or ùêñùêä‚Åª¬πùêñ·µÄ)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/kronecker/kron.jl#L145-L149">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.log_det_posterior_precision-Tuple{LaplaceRedux.AbstractLaplace}" href="#LaplaceRedux.log_det_posterior_precision-Tuple{LaplaceRedux.AbstractLaplace}"><code>LaplaceRedux.log_det_posterior_precision</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">log_det_posterior_precision(la::AbstractLaplace)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/utils.jl#L152-L156">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.log_det_prior_precision-Tuple{LaplaceRedux.AbstractLaplace}" href="#LaplaceRedux.log_det_prior_precision-Tuple{LaplaceRedux.AbstractLaplace}"><code>LaplaceRedux.log_det_prior_precision</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">log_det_prior_precision(la::AbstractLaplace)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/utils.jl#L145-L149">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.log_det_ratio-Tuple{LaplaceRedux.AbstractLaplace}" href="#LaplaceRedux.log_det_ratio-Tuple{LaplaceRedux.AbstractLaplace}"><code>LaplaceRedux.log_det_ratio</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">log_det_ratio(la::AbstractLaplace)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/utils.jl#L136-L140">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.log_likelihood-Tuple{LaplaceRedux.AbstractLaplace}" href="#LaplaceRedux.log_likelihood-Tuple{LaplaceRedux.AbstractLaplace}"><code>LaplaceRedux.log_likelihood</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">log_likelihood(la::AbstractLaplace)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/utils.jl#L65-L69">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.log_marginal_likelihood-Tuple{LaplaceRedux.AbstractLaplace}" href="#LaplaceRedux.log_marginal_likelihood-Tuple{LaplaceRedux.AbstractLaplace}"><code>LaplaceRedux.log_marginal_likelihood</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">log_marginal_likelihood(la::AbstractLaplace; P‚ÇÄ::Union{Nothing,UniformScaling}=nothing, œÉ::Union{Nothing, Real}=nothing)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/utils.jl#L110-L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.logdetblock-Tuple{Tuple{LinearAlgebra.Eigen, LinearAlgebra.Eigen}, Number}" href="#LaplaceRedux.logdetblock-Tuple{Tuple{LinearAlgebra.Eigen, LinearAlgebra.Eigen}, Number}"><code>LaplaceRedux.logdetblock</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">logdetblock(block::Tuple{Eigen,Eigen}, delta::Number)</code></pre><p>Log-determinant of a block in KronDecomposed, shifted by delta by on the diagonal.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/kronecker/utils.jl#L149-L153">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.mm-Tuple{LaplaceRedux.KronDecomposed, Any}" href="#LaplaceRedux.mm-Tuple{LaplaceRedux.KronDecomposed, Any}"><code>LaplaceRedux.mm</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><p>Matrix-multuply for the KronDecomposed Hessian approximation K and a 2-d matrix W, applying an exponent to K and transposing W before multiplication. Return <code>(K^x)W^T</code>, where <code>x</code> is the exponent.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/kronecker/utils.jl#L177-L181">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.n_params-Tuple{Any, LaplaceRedux.EstimationParams}" href="#LaplaceRedux.n_params-Tuple{Any, LaplaceRedux.EstimationParams}"><code>LaplaceRedux.n_params</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">n_params(model::Any, params::EstimationParams)</code></pre><p>Helper function to determine the number of parameters of a <code>Flux.Chain</code> with Laplace approximation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/estimation_params.jl#L73-L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.n_params-Tuple{Laplace}" href="#LaplaceRedux.n_params-Tuple{Laplace}"><code>LaplaceRedux.n_params</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">LaplaceRedux.n_params(la::Laplace)</code></pre><p>Overloads the <code>n_params</code> function for a <code>Laplace</code> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/utils.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.outdim-Tuple{Flux.Chain}" href="#LaplaceRedux.outdim-Tuple{Flux.Chain}"><code>LaplaceRedux.outdim</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">outdim(model::Chain)</code></pre><p>Helper function to determine the output dimension of a <code>Flux.Chain</code>, corresponding to the number of neurons on the last layer of the NN.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/utils.jl#L33-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.outdim-Tuple{LaplaceRedux.AbstractLaplace}" href="#LaplaceRedux.outdim-Tuple{LaplaceRedux.AbstractLaplace}"><code>LaplaceRedux.outdim</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">outdim(la::AbstractLaplace)</code></pre><p>Helper function to determine the output dimension, corresponding to the number of neurons  on the last layer of the NN, of a <code>Flux.Chain</code> with Laplace approximation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/utils.jl#L33-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.prior_precision-Tuple{Laplace}" href="#LaplaceRedux.prior_precision-Tuple{Laplace}"><code>LaplaceRedux.prior_precision</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">prior_precision(la::Laplace)</code></pre><p>Helper function to extract the prior precision matrix from a Laplace approximation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/utils.jl#L24-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.probit-Tuple{AbstractArray, AbstractArray}" href="#LaplaceRedux.probit-Tuple{AbstractArray, AbstractArray}"><code>LaplaceRedux.probit</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">probit(fŒº::AbstractArray, fvar::AbstractArray)</code></pre><p>Compute the probit approximation of the predictive distribution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/baselaplace/predicting.jl#L181-L185">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.validate_subnetwork_indices-Tuple{Union{Nothing, Vector{Vector{Int64}}}, Any}" href="#LaplaceRedux.validate_subnetwork_indices-Tuple{Union{Nothing, Vector{Vector{Int64}}}, Any}"><code>LaplaceRedux.validate_subnetwork_indices</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><p>validate<em>subnetwork</em>indices( subnetwork_indices::Union{Nothing,Vector{Vector{Int}}}, params )</p><p>Determines whether subnetwork_indices is a valid input for specified parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/subnet.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LinearAlgebra.det-Tuple{LaplaceRedux.KronDecomposed}" href="#LinearAlgebra.det-Tuple{LaplaceRedux.KronDecomposed}"><code>LinearAlgebra.det</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">det(K::KronDecomposed)</code></pre><p>Log-determinant of the KronDecomposed block-diagonal matrix, as the exponentiated log-determinant.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/kronecker/utils.jl#L168-L172">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LinearAlgebra.logdet-Tuple{LaplaceRedux.KronDecomposed}" href="#LinearAlgebra.logdet-Tuple{LaplaceRedux.KronDecomposed}"><code>LinearAlgebra.logdet</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">logdet(K::KronDecomposed)</code></pre><p>Log-determinant of the KronDecomposed block-diagonal matrix, as the product of the determinants of the blocks</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/kronecker/utils.jl#L159-L163">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLJFlux.build-Tuple{LaplaceClassification, Any, Any}" href="#MLJFlux.build-Tuple{LaplaceClassification, Any, Any}"><code>MLJFlux.build</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">MLJFlux.build(model::LaplaceClassification, rng, shape)</code></pre><p>Builds an MLJFlux model for Laplace classification compatible with the dimensions of the input and output layers specified by <code>shape</code>.</p><p><strong>Arguments</strong></p><ul><li><code>model::LaplaceClassification</code>: The Laplace classification model.</li><li><code>rng</code>: A random number generator to ensure reproducibility.</li><li><code>shape</code>: A tuple or array specifying the dimensions of the input and output layers.</li></ul><p><strong>Returns</strong></p><ul><li>The constructed MLJFlux model, compatible with the specified input and output dimensions.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/mlj_flux.jl#L319-L331">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLJFlux.build-Tuple{LaplaceRegression, Any, Any}" href="#MLJFlux.build-Tuple{LaplaceRegression, Any, Any}"><code>MLJFlux.build</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">MLJFlux.build(model::LaplaceRegression, rng, shape)</code></pre><p>Builds an MLJFlux model for Laplace regression compatible with the dimensions of the input and output layers specified by <code>shape</code>.</p><p><strong>Arguments</strong></p><ul><li><code>model::LaplaceRegression</code>: The Laplace regression model.</li><li><code>rng</code>: A random number generator to ensure reproducibility.</li><li><code>shape</code>: A tuple or array specifying the dimensions of the input and output layers.</li></ul><p><strong>Returns</strong></p><ul><li>The constructed MLJFlux model, compatible with the specified input and output dimensions.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/mlj_flux.jl#L153-L165">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLJFlux.fitresult-Tuple{LaplaceClassification, Any, Any}" href="#MLJFlux.fitresult-Tuple{LaplaceClassification, Any, Any}"><code>MLJFlux.fitresult</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">MLJFlux.fitresult(model::LaplaceClassification, chain, y)</code></pre><p>Computes the fit result for a Laplace classification model, returning the model chain and the number of unique classes in the target data.</p><p><strong>Arguments</strong></p><ul><li><code>model::LaplaceClassification</code>: The Laplace classification model to be evaluated.</li><li><code>chain</code>: The trained model chain.</li><li><code>y</code>: The target data, typically a vector of class labels.</li></ul><p><strong>Returns</strong></p><p><strong>Returns</strong></p><p>A tuple containing:</p><ul><li>The trained Flux chain.</li><li>a deepcopy of the laplace model.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/mlj_flux.jl#L338-L353">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLJFlux.fitresult-Tuple{LaplaceRegression, Any, Any}" href="#MLJFlux.fitresult-Tuple{LaplaceRegression, Any, Any}"><code>MLJFlux.fitresult</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">MLJFlux.fitresult(model::LaplaceRegression, chain, y)</code></pre><p>Computes the fit result for a Laplace Regression model, returning the model chain and the number of output variables in the target data.</p><p><strong>Arguments</strong></p><ul><li><code>model::LaplaceRegression</code>: The Laplace Regression model to be evaluated.</li><li><code>chain</code>: The trained model chain.</li><li><code>y</code>: The target data, typically a vector of class labels.</li></ul><p><strong>Returns</strong></p><p>A tuple containing:</p><ul><li>The trained Flux chain.</li><li>a deepcopy of the laplace model.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/mlj_flux.jl#L171-L185">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLJFlux.shape-Tuple{LaplaceRegression, Any, Any}" href="#MLJFlux.shape-Tuple{LaplaceRegression, Any, Any}"><code>MLJFlux.shape</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">MLJFlux.shape(model::LaplaceRegression, X, y)</code></pre><p>Compute the the number of features of the X input dataset and  the number of variables to predict from  the y  output dataset.</p><p><strong>Arguments</strong></p><ul><li><code>model::LaplaceRegression</code>: The LaplaceRegression model to fit.</li><li><code>X</code>: The input data for training.</li><li><code>y</code>: The target labels for training one-hot encoded.</li></ul><p><strong>Returns</strong></p><ul><li>(input size, output size)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/mlj_flux.jl#L128-L140">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLJFlux.train-Tuple{LaplaceClassification, Vararg{Any, 7}}" href="#MLJFlux.train-Tuple{LaplaceClassification, Vararg{Any, 7}}"><code>MLJFlux.train</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">MLJFlux.train(model::LaplaceClassification, chain, regularized_optimiser, optimiser_state, epochs, verbosity, X, y)</code></pre><p>Fit the LaplaceRegression model using Flux.jl.</p><p><strong>Arguments</strong></p><ul><li><code>model::LaplaceClassification</code>: The LaplaceClassification model.</li><li><code>regularized_optimiser</code>: the regularized optimiser to apply to the loss function.</li><li><code>optimiser_state</code>: thestate of the optimiser.</li><li><code>epochs</code>: The number of epochs for training.</li><li><code>verbosity</code>: The verbosity level for training.</li><li><code>X</code>: The input data for training.</li><li><code>y</code>: The target labels for training.</li></ul><p><strong>Returns (fitresult, cache, report )</strong></p><p>where</p><ul><li><code>la</code>: the fitted Laplace model.</li><li><code>optimiser_state</code>: the state of the optimiser.</li><li><code>history</code>: the training loss history.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/mlj_flux.jl#L358-L377">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLJFlux.train-Tuple{LaplaceRegression, Vararg{Any, 7}}" href="#MLJFlux.train-Tuple{LaplaceRegression, Vararg{Any, 7}}"><code>MLJFlux.train</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">MLJFlux.train(model::LaplaceRegression, chain, regularized_optimiser, optimiser_state, epochs, verbosity, X, y)</code></pre><p>Fit the LaplaceRegression model using Flux.jl.</p><p><strong>Arguments</strong></p><ul><li><code>model::LaplaceRegression</code>: The LaplaceRegression model.</li><li><code>regularized_optimiser</code>: the regularized optimiser to apply to the loss function.</li><li><code>optimiser_state</code>: thestate of the optimiser.</li><li><code>epochs</code>: The number of epochs for training.</li><li><code>verbosity</code>: The verbosity level for training.</li><li><code>X</code>: The input data for training.</li><li><code>y</code>: The target labels for training.</li></ul><p><strong>Returns (la, optimiser_state, history )</strong></p><p>where</p><ul><li><code>la</code>: the fitted Laplace model.</li><li><code>optimiser_state</code>: the state of the optimiser.</li><li><code>history</code>: the training loss history.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/mlj_flux.jl#L190-L209">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.@zb-Tuple{Any}" href="#LaplaceRedux.@zb-Tuple{Any}"><code>LaplaceRedux.@zb</code></a> ‚Äî <span class="docstring-category">Macro</span></header><section><div><p>Macro for zero-based indexing. Example of usage: (@zb A[0]) = ...</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/kronecker/utils.jl#L4-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.Curvature.EmpiricalFisher" href="#LaplaceRedux.Curvature.EmpiricalFisher"><code>LaplaceRedux.Curvature.EmpiricalFisher</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><p>Constructor for curvature approximated by empirical Fisher.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/curvature/fisher.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.Curvature.GGN" href="#LaplaceRedux.Curvature.GGN"><code>LaplaceRedux.Curvature.GGN</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><p>Constructor for curvature approximated by Generalized Gauss-Newton.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/curvature/ggn.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.Curvature.full_batched-Tuple{LaplaceRedux.Curvature.EmpiricalFisher, Tuple}" href="#LaplaceRedux.Curvature.full_batched-Tuple{LaplaceRedux.Curvature.EmpiricalFisher, Tuple}"><code>LaplaceRedux.Curvature.full_batched</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">full_batched(curvature::EmpiricalFisher, d::Tuple)</code></pre><p>Compute the full empirical Fisher for batch of inputs-outputs, with the batch dimension at the end.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/curvature/fisher.jl#L53-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.Curvature.full_batched-Tuple{LaplaceRedux.Curvature.GGN, Tuple}" href="#LaplaceRedux.Curvature.full_batched-Tuple{LaplaceRedux.Curvature.GGN, Tuple}"><code>LaplaceRedux.Curvature.full_batched</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">full_batched(curvature::GGN, d::Tuple)</code></pre><p>Compute the full GGN for batch of inputs-outputs, with the batch dimension at the end.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/curvature/ggn.jl#L52-L56">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.Curvature.full_unbatched-Tuple{LaplaceRedux.Curvature.EmpiricalFisher, Tuple}" href="#LaplaceRedux.Curvature.full_unbatched-Tuple{LaplaceRedux.Curvature.EmpiricalFisher, Tuple}"><code>LaplaceRedux.Curvature.full_unbatched</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">full_unbatched(curvature::EmpiricalFisher, d::Tuple)</code></pre><p>Compute the full empirical Fisher for a single datapoint.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/curvature/fisher.jl#L28-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.Curvature.full_unbatched-Tuple{LaplaceRedux.Curvature.GGN, Tuple}" href="#LaplaceRedux.Curvature.full_unbatched-Tuple{LaplaceRedux.Curvature.GGN, Tuple}"><code>LaplaceRedux.Curvature.full_unbatched</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">full_unbatched(curvature::GGN, d::Tuple)</code></pre><p>Compute the full GGN for a singular input-ouput datapoint. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/curvature/ggn.jl#L28-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.Curvature.gradients-Tuple{LaplaceRedux.Curvature.CurvatureInterface, AbstractArray, Union{Number, AbstractArray}}" href="#LaplaceRedux.Curvature.gradients-Tuple{LaplaceRedux.Curvature.CurvatureInterface, AbstractArray, Union{Number, AbstractArray}}"><code>LaplaceRedux.Curvature.gradients</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">gradients(curvature::CurvatureInterface, X::AbstractArray, y::Number)</code></pre><p>Compute the gradients with respect to the loss function: <code>‚àá‚Ñì(f(x;Œ∏),y)</code> where <code>f: ‚Ñù·¥∞ ‚Ü¶ ‚Ñù·¥∑</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/curvature/utils.jl#L75-L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.Curvature.jacobians-Tuple{LaplaceRedux.Curvature.CurvatureInterface, AbstractArray}" href="#LaplaceRedux.Curvature.jacobians-Tuple{LaplaceRedux.Curvature.CurvatureInterface, AbstractArray}"><code>LaplaceRedux.Curvature.jacobians</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">jacobians(curvature::CurvatureInterface, X::AbstractArray; batched::Bool=false)</code></pre><p>Computes the Jacobian <code>‚àáf(x;Œ∏)</code> where <code>f: ‚Ñù·¥∞ ‚Ü¶ ‚Ñù·¥∑</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/curvature/utils.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.Curvature.jacobians_batched-Tuple{LaplaceRedux.Curvature.CurvatureInterface, AbstractArray}" href="#LaplaceRedux.Curvature.jacobians_batched-Tuple{LaplaceRedux.Curvature.CurvatureInterface, AbstractArray}"><code>LaplaceRedux.Curvature.jacobians_batched</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">jacobians_batched(curvature::CurvatureInterface, X::AbstractArray)</code></pre><p>Compute Jacobians of the model output w.r.t. model parameters for points in X, with batching.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/curvature/utils.jl#L44-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.Curvature.jacobians_unbatched-Tuple{LaplaceRedux.Curvature.CurvatureInterface, AbstractArray}" href="#LaplaceRedux.Curvature.jacobians_unbatched-Tuple{LaplaceRedux.Curvature.CurvatureInterface, AbstractArray}"><code>LaplaceRedux.Curvature.jacobians_unbatched</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">jacobians_unbatched(curvature::CurvatureInterface, X::AbstractArray)</code></pre><p>Compute the Jacobian of the model output w.r.t. model parameters for the point X, without batching. Here, the nn function is wrapped in an anonymous function using the () -&gt; syntax, which allows it to be differentiated using automatic differentiation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/curvature/utils.jl#L16-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.Data.toy_data_linear" href="#LaplaceRedux.Data.toy_data_linear"><code>LaplaceRedux.Data.toy_data_linear</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">toy_data_linear(N=100)</code></pre><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">toy_data_linear()</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/data/functions.jl#L1-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.Data.toy_data_multi" href="#LaplaceRedux.Data.toy_data_multi"><code>LaplaceRedux.Data.toy_data_multi</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">toy_data_multi(N=100)</code></pre><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">toy_data_multi()</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/data/functions.jl#L66-L75">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.Data.toy_data_non_linear" href="#LaplaceRedux.Data.toy_data_non_linear"><code>LaplaceRedux.Data.toy_data_non_linear</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">toy_data_non_linear(N=100)</code></pre><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">toy_data_non_linear()</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/data/functions.jl#L29-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LaplaceRedux.Data.toy_data_regression" href="#LaplaceRedux.Data.toy_data_regression"><code>LaplaceRedux.Data.toy_data_regression</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">toy_data_regression(N=25, p=1; noise=0.3, fun::Function=f(x)=sin(2 * œÄ * x))</code></pre><p>A helper function to generate synthetic data for regression.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl/blob/45098072e6ddd26dd8341f92c879139f42548603/src/data/functions.jl#L103-L107">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorials/prior/">¬´ A note on the prior ...</a><a class="docs-footer-nextpage" href="../resources/_resources/">Additional Resources ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Monday 22 July 2024 08:48">Monday 22 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
