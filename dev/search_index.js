var documenterSearchIndex = {"docs":
[{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"","category":"page"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"pagetitle: quick_start toc-title: Table of contents ‚Äì-","category":"page"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"CurrentModule = BayesLaplace","category":"page"},{"location":"quick_start/#Quick-start","page":"Getting started","title":"Quick start","text":"","category":"section"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"<div class=\"cell\" execution_count=\"166\">","category":"page"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"# Import libraries.\nusing Flux, Plots, Random, PlotThemes, Statistics, BayesLaplace\ntheme(:juno)\nusing Logging\ndisable_logging(Logging.Info)","category":"page"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"<div class=\"cell-output-display\">","category":"page"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"LogLevel(1)","category":"page"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"</div>","category":"page"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"</div>","category":"page"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"# Number of points to generate.\nN = 100\nM = round(Int, N / 4)\nRandom.seed!(1234)\n\n# Generate artificial data.\nx1s = rand(M) * 4.5; x2s = rand(M) * 4.5; \nxt1s = Array([[x1s[i] + 0.5; x2s[i] + 0.5] for i = 1:M])\nx1s = rand(M) * 4.5; x2s = rand(M) * 4.5; \nappend!(xt1s, Array([[x1s[i] - 5; x2s[i] - 5] for i = 1:M]))\n\nx1s = rand(M) * 4.5; x2s = rand(M) * 4.5; \nxt0s = Array([[x1s[i] + 0.5; x2s[i] - 5] for i = 1:M])\nx1s = rand(M) * 4.5; x2s = rand(M) * 4.5; \nappend!(xt0s, Array([[x1s[i] - 5; x2s[i] + 0.5] for i = 1:M]))\n\n# Store all the data for later.\nxs = [xt1s; xt0s]\nX = hcat(xs...) # bring into tabular format\nts = [ones(2*M); zeros(2*M)];\n\nplt = plot()\n\n# Plot data points.\nfunction plot_data!(plt,X,y)\n    Plots.scatter!(plt, X[y.==1.0,1],X[y.==1.0,2], color=1, clim = (0,1), label=\"y=1\")\n    Plots.scatter!(plt, X[y.==0.0,1],X[y.==0.0,2], color=0, clim = (0,1), label=\"y=0\")\nend\n\nplt = plot_data!(plt,X',ts);","category":"page"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"<div class=\"cell\" execution_count=\"168\">","category":"page"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"function build_model(;input_dim=2,n_hidden=32,output_dim=1)\n    \n    # Params:\n    W‚ÇÅ = input_dim\n    b‚ÇÅ = n_hidden\n    W‚ÇÄ = n_hidden\n    b‚ÇÄ = output_dim\n    \n    nn = Chain(\n        Dense(W‚ÇÅ, b‚ÇÅ, œÉ),\n        Dense(W‚ÇÄ, b‚ÇÄ))  \n\n    return nn\n\nend\nnn = build_model()","category":"page"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"<div class=\"cell-output-display\">","category":"page"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"Chain(\n  Dense(2, 32, œÉ),                      \u001b[90m# 96 parameters\u001b[39m\n  Dense(32, 1),                         \u001b[90m# 33 parameters\u001b[39m\n)\u001b[90m                   # Total: 4 arrays, \u001b[39m129 parameters, 772 bytes.","category":"page"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"</div>","category":"page"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"</div>","category":"page"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"<div class=\"cell\" execution_count=\"169\">","category":"page"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"Œª = 1e-10","category":"page"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"<div class=\"cell-output-display\">","category":"page"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"1.0e-10","category":"page"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"</div>","category":"page"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"</div>","category":"page"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"sqnorm(x) = sum(abs2, x)\nweight_regularization(Œª=Œª) = 1/2 * Œª^2 * sum(sqnorm, Flux.params(nn))\n\nloss(x, y) = Flux.Losses.logitbinarycrossentropy(nn(x), y) + weight_regularization()\nps = Flux.params(nn)\ndata = zip(xs,ts);","category":"page"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"using Flux.Optimise: update!, ADAM\nopt = ADAM()\nepochs = 200\navg_loss(data) = mean(map(d -> loss(d[1],d[2]), data))\n\nusing Plots\nanim = Animation()\nplt = plot(ylim=(0,avg_loss(data)), xlim=(0,epochs), legend=false, xlab=\"Epoch\")\navg_l = []\n\nfor epoch = 1:epochs\n  for d in data\n    gs = gradient(params(nn)) do\n      l = loss(d...)\n    end\n    update!(opt, params(nn), gs)\n  end\n  avg_l = vcat(avg_l,avg_loss(data))\n  plot!(plt, avg_l, color=1, title=\"Average (training) loss\")\n  frame(anim, plt)\nend\n\ngif(anim, \"www/nn_training.gif\");","category":"page"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"(Image: )","category":"page"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"predictive(ùë¥::Flux.Chain, X::AbstractArray) = Flux.œÉ.(nn(X))\n# Plot the posterior distribution with a contour plot.\nfunction plot_contour(X,y,ùë¥;clegend=true,title=\"\",length_out=30)\n    x_range = collect(range(minimum(X[:,1]),stop=maximum(X[:,1]),length=length_out))\n    y_range = collect(range(minimum(X[:,2]),stop=maximum(X[:,2]),length=length_out))\n    Z = [predictive(ùë¥,[x, y])[1] for x=x_range, y=y_range]\n    plt = contourf(x_range, y_range, Z', color=:plasma, legend=clegend, title=title, linewidth=0)\n    plot_data!(plt,X,y)\nend\np_plugin = plot_contour(X',ts,nn;title=\"Plugin\");","category":"page"},{"location":"quick_start/#Laplace-appoximation","page":"Getting started","title":"Laplace appoximation","text":"","category":"section"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"la = laplace(nn, Œª=0.1)\nfit!(la, data);\npredictive(ùë¥::BayesLaplace.LaplaceRedux, X::AbstractArray) = predict(ùë¥, X)\np_laplace = plot_contour(X',ts,la;title=\"Laplace\");","category":"page"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"# Plot the posterior distribution with a contour plot.\nplt = plot(p_plugin, p_laplace, layout=(1,2), size=(1000,400));\nsavefig(plt, \"www/posterior_predictive.png\")","category":"page"},{"location":"quick_start/","page":"Getting started","title":"Getting started","text":"(Image: )","category":"page"},{"location":"","page":"Home","title":"Home","text":"CurrentModule = BayesLaplace","category":"page"},{"location":"#BayesLaplace","page":"Home","title":"BayesLaplace","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Documentation for BayesLaplace.","category":"page"},{"location":"","page":"Home","title":"Home","text":"","category":"page"},{"location":"","page":"Home","title":"Home","text":"Modules = [BayesLaplace]","category":"page"}]
}
